

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>octoprint.server &mdash; OctoPrint maintenance documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/mermaid.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="octoprint.settings" href="settings.html" />
    <link rel="prev" title="octoprint.printer" href="printer.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> OctoPrint
          

          
          </a>

          
            
            
              <div class="version">
                maintenance
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bundledplugins/index.html">Bundled Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../events/index.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Developing Plugins</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Internal Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cli.html">octoprint.cli</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#module-octoprint.cli.dev">octoprint.cli.dev</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#module-octoprint.cli.plugins">octoprint.cli.plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#module-octoprint.cli.server">octoprint.cli.server</a></li>
<li class="toctree-l2"><a class="reference internal" href="filemanager.html">octoprint.filemanager</a></li>
<li class="toctree-l2"><a class="reference internal" href="filemanager.html#module-octoprint.filemanager.analysis">octoprint.filemanager.analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="filemanager.html#module-octoprint.filemanager.destinations">octoprint.filemanager.destinations</a></li>
<li class="toctree-l2"><a class="reference internal" href="filemanager.html#module-octoprint.filemanager.storage">octoprint.filemanager.storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="filemanager.html#module-octoprint.filemanager.util">octoprint.filemanager.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin.html">octoprint.plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin.html#module-octoprint.plugin.core">octoprint.plugin.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin.html#module-octoprint.plugin.types">octoprint.plugin.types</a></li>
<li class="toctree-l2"><a class="reference internal" href="printer.html">octoprint.printer</a></li>
<li class="toctree-l2"><a class="reference internal" href="printer.html#module-octoprint.printer.profile">octoprint.printer.profile</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">octoprint.server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-octoprint.server.util">octoprint.server.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-octoprint.server.util.flask">octoprint.server.util.flask</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-octoprint.server.util.sockjs">octoprint.server.util.sockjs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-octoprint.server.util.tornado">octoprint.server.util.tornado</a></li>
<li class="toctree-l2"><a class="reference internal" href="settings.html">octoprint.settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="slicing.html">octoprint.slicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="slicing.html#module-octoprint.slicing.exceptions">octoprint.slicing.exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html">octoprint.access.users</a></li>
<li class="toctree-l2"><a class="reference internal" href="util.html">octoprint.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="util.html#module-octoprint.util.commandline">octoprint.util.commandline</a></li>
<li class="toctree-l2"><a class="reference internal" href="util.html#module-octoprint.util.platform">octoprint.util.platform</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jsclientlib/index.html">JavaScript Client Library</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OctoPrint</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">


  <p style="padding: 10px;margin: 0 0 10px 0;border-radius: 2px;letter-spacing: 1px;font-size: 13px;color: white;text-align: center;background: #3a87ad;background-image: none;background-size: auto;background-size: 28px 28px;background-image: linear-gradient( -45deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.2) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.2) 50%, rgba(255, 255, 255, 0.2) 75%, transparent 75%, transparent );">
    <strong>Note:</strong>
    These are not the docs of the latest released version. Those can be found <a href="https://docs.octoprint.org/en/1.6.1" style="color: white;text-decoration: underline">here</a>.
  </p>


  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Internal Modules</a> &raquo;</li>
        
      <li>octoprint.server</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/modules/server.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-octoprint.server">
<span id="octoprint-server"></span><span id="sec-modules-server"></span><h1>octoprint.server<a class="headerlink" href="#module-octoprint.server" title="Permalink to this headline">¶</a></h1>
<dl class="py exception">
<dt id="octoprint.server.CannotStartServerException">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.</span></code><code class="sig-name descname"><span class="pre">CannotStartServerException</span></code><a class="headerlink" href="#octoprint.server.CannotStartServerException" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-octoprint.server.util">
<span id="octoprint-server-util"></span><span id="sec-modules-server-util"></span><h1>octoprint.server.util<a class="headerlink" href="#module-octoprint.server.util" title="Permalink to this headline">¶</a></h1>
<dl class="py exception">
<dt id="octoprint.server.util.InvalidApiKeyException">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.</span></code><code class="sig-name descname"><span class="pre">InvalidApiKeyException</span></code><a class="headerlink" href="#octoprint.server.util.InvalidApiKeyException" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.corsRequestHandler">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.</span></code><code class="sig-name descname"><span class="pre">corsRequestHandler</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.corsRequestHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">before_request</span></code> handler for blueprints which sets CORS headers for OPTIONS requests if enabled</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.corsResponseHandler">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.</span></code><code class="sig-name descname"><span class="pre">corsResponseHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.corsResponseHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">after_request</span></code> handler for blueprints for which CORS is supported.</p>
<p>Sets <code class="docutils literal notranslate"><span class="pre">Access-Control-Allow-Origin</span></code> headers for <code class="docutils literal notranslate"><span class="pre">Origin</span></code> request header on response.</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.has_permissions">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.</span></code><code class="sig-name descname"><span class="pre">has_permissions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">permissions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.has_permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the current user (either from the session, api key or authorization
header) has all of the requested permissions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*permissions</strong> – list of all permissions required to pass the check</p>
</dd>
</dl>
<p>Returns: True if the user has all permissions, False otherwise</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.loginFromApiKeyRequestHandler">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.</span></code><code class="sig-name descname"><span class="pre">loginFromApiKeyRequestHandler</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.loginFromApiKeyRequestHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">before_request</span></code> handler for blueprints which creates a login session for the provided api key (if available)</p>
<p>App session keys are handled as anonymous keys here and ignored.</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.loginFromAuthorizationHeaderRequestHandler">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.</span></code><code class="sig-name descname"><span class="pre">loginFromAuthorizationHeaderRequestHandler</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.loginFromAuthorizationHeaderRequestHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">before_request</span></code> handler for creating login sessions based on the Authorization header.</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.loginUser">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.</span></code><code class="sig-name descname"><span class="pre">loginUser</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remember</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">login_mechanism</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.loginUser" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs the provided <code class="docutils literal notranslate"><span class="pre">user</span></code> into Flask Login and Principal if not None and active</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user</strong> – the User to login. May be None in which case the login will fail</p></li>
<li><p><strong>remember</strong> – Whether to set the <code class="docutils literal notranslate"><span class="pre">remember</span></code> flag on the Flask Login operation</p></li>
</ul>
</dd>
</dl>
<p>Returns: (bool) True if the login succeeded, False otherwise</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.noCachingExceptGetResponseHandler">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.</span></code><code class="sig-name descname"><span class="pre">noCachingExceptGetResponseHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.noCachingExceptGetResponseHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">after_request</span></code> handler for blueprints which shall set no caching headers
on their responses to any requests that are not sent with method <code class="docutils literal notranslate"><span class="pre">GET</span></code>.</p>
<p>See <a class="reference internal" href="#octoprint.server.util.noCachingResponseHandler" title="octoprint.server.util.noCachingResponseHandler"><code class="xref py py-func docutils literal notranslate"><span class="pre">noCachingResponseHandler()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.noCachingResponseHandler">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.</span></code><code class="sig-name descname"><span class="pre">noCachingResponseHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.noCachingResponseHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">after_request</span></code> handler for blueprints which shall set no caching headers
on their responses.</p>
<p>Sets <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code>, <code class="docutils literal notranslate"><span class="pre">Pragma</span></code> and <code class="docutils literal notranslate"><span class="pre">Expires</span></code> headers accordingly
to prevent all client side caching from taking place.</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.optionsAllowOrigin">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.</span></code><code class="sig-name descname"><span class="pre">optionsAllowOrigin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.optionsAllowOrigin" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for request handling for CORS OPTIONS requests to set CORS headers.</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.require_login">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.</span></code><code class="sig-name descname"><span class="pre">require_login</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">permissions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.require_login" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a redirect response to the login view if the permission requirements are
not met.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*permissions</strong> – a list of permissions required to pass the check</p>
</dd>
</dl>
<p>Returns: a flask redirect response to return if a login is required, or None</p>
</dd></dl>

</div>
<div class="section" id="module-octoprint.server.util.flask">
<span id="octoprint-server-util-flask"></span><span id="sec-modules-server-util-flask"></span><h1>octoprint.server.util.flask<a class="headerlink" href="#module-octoprint.server.util.flask" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="octoprint.server.util.flask.LessSimpleCache">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">LessSimpleCache</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.LessSimpleCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Slightly improved version of <code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleCache</span></code>.</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">default_timeout</span></code> or <code class="docutils literal notranslate"><span class="pre">timeout</span></code> to <code class="docutils literal notranslate"><span class="pre">-1</span></code> will have no timeout be applied at all.</p>
<dl class="py method">
<dt id="octoprint.server.util.flask.LessSimpleCache.add">
<code class="sig-name descname"><span class="pre">add</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.LessSimpleCache.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Works like <a class="reference internal" href="#octoprint.server.util.flask.LessSimpleCache.set" title="octoprint.server.util.flask.LessSimpleCache.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set()</span></code></a> but does not overwrite the values of already
existing keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – the key to set</p></li>
<li><p><strong>value</strong> – the value for the key</p></li>
<li><p><strong>timeout</strong> – the cache timeout for the key in seconds (if not
specified, it uses the default timeout). A timeout of
0 indicates that the cache never expires.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Same as <a class="reference internal" href="#octoprint.server.util.flask.LessSimpleCache.set" title="octoprint.server.util.flask.LessSimpleCache.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set()</span></code></a>, but also <code class="docutils literal notranslate"><span class="pre">False</span></code> for already
existing keys.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.flask.LessSimpleCache.delete">
<code class="sig-name descname"><span class="pre">delete</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.LessSimpleCache.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete <cite>key</cite> from the cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – the key to delete.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the key existed and has been deleted.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.flask.LessSimpleCache.get">
<code class="sig-name descname"><span class="pre">get</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.LessSimpleCache.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Look up key in the cache and return the value for it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – the key to be looked up.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value if it exists and is readable, else <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.flask.LessSimpleCache.set">
<code class="sig-name descname"><span class="pre">set</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.LessSimpleCache.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new key/value to the cache (overwrites value, if key already
exists in the cache).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – the key to set</p></li>
<li><p><strong>value</strong> – the value for the key</p></li>
<li><p><strong>timeout</strong> – the cache timeout for the key in seconds (if not
specified, it uses the default timeout). A timeout of
0 indicates that the cache never expires.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if key has been updated, <code class="docutils literal notranslate"><span class="pre">False</span></code> for backend
errors. Pickling errors, however, will raise a subclass of
<code class="docutils literal notranslate"><span class="pre">pickle.PickleError</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.flask.OctoPrintFlaskRequest">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">OctoPrintFlaskRequest</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environ</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskRequest" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="octoprint.server.util.flask.OctoPrintFlaskRequest.cookie_suffix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">cookie_suffix</span></code><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskRequest.cookie_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Request specific suffix for set and read cookies</p>
<p>We need this because cookies are not port-specific and we don’t want to overwrite our
session and other cookies from one OctoPrint instance on our machine with those of another
one who happens to listen on the same address albeit a different port or script root.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.flask.OctoPrintFlaskRequest.server_name">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">server_name</span></code><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskRequest.server_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Short cut to the request’s server name header</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.flask.OctoPrintFlaskRequest.server_port">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">server_port</span></code><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskRequest.server_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Short cut to the request’s server port header</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.flask.OctoPrintFlaskResponse">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">OctoPrintFlaskResponse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mimetype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct_passthrough</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskResponse" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="octoprint.server.util.flask.OctoPrintFlaskResponse.delete_cookie">
<code class="sig-name descname"><span class="pre">delete_cookie</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskResponse.delete_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a cookie.  Fails silently if key doesn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – the key (name) of the cookie to be deleted.</p></li>
<li><p><strong>path</strong> – if the cookie that should be deleted was limited to a
path, the path has to be defined here.</p></li>
<li><p><strong>domain</strong> – if the cookie that should be deleted was limited to a
domain, that domain has to be defined here.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.flask.OctoPrintFlaskResponse.set_cookie">
<code class="sig-name descname"><span class="pre">set_cookie</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskResponse.set_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a cookie. The parameters are the same as in the cookie <cite>Morsel</cite>
object in the Python standard library but it accepts unicode data, too.</p>
<p>A warning is raised if the size of the cookie header exceeds
<code class="xref py py-attr docutils literal notranslate"><span class="pre">max_cookie_size</span></code>, but the header will still be set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – the key (name) of the cookie to be set.</p></li>
<li><p><strong>value</strong> – the value of the cookie.</p></li>
<li><p><strong>max_age</strong> – should be a number of seconds, or <cite>None</cite> (default) if
the cookie should last only as long as the client’s
browser session.</p></li>
<li><p><strong>expires</strong> – should be a <cite>datetime</cite> object or UNIX timestamp.</p></li>
<li><p><strong>path</strong> – limits the cookie to a given path, per default it will
span the whole domain.</p></li>
<li><p><strong>domain</strong> – if you want to set a cross-domain cookie.  For example,
<code class="docutils literal notranslate"><span class="pre">domain=&quot;.example.com&quot;</span></code> will set a cookie that is
readable by the domain <code class="docutils literal notranslate"><span class="pre">www.example.com</span></code>,
<code class="docutils literal notranslate"><span class="pre">foo.example.com</span></code> etc.  Otherwise, a cookie will only
be readable by the domain that set it.</p></li>
<li><p><strong>secure</strong> – If <cite>True</cite>, the cookie will only be available via HTTPS</p></li>
<li><p><strong>httponly</strong> – disallow JavaScript to access the cookie.  This is an
extension to the cookie standard and probably not
supported by all browsers.</p></li>
<li><p><strong>samesite</strong> – Limits the scope of the cookie such that it will only
be attached to requests if those requests are
“same-site”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.flask.OctoPrintJsonEncoder">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">OctoPrintJsonEncoder</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipkeys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_circular</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintJsonEncoder" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="octoprint.server.util.flask.OctoPrintJsonEncoder.default">
<code class="sig-name descname"><span class="pre">default</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintJsonEncoder.default" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement this method in a subclass such that it returns a
serializable object for <code class="docutils literal notranslate"><span class="pre">o</span></code>, or calls the base implementation (to
raise a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.9)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a>).</p>
<p>For example, to support arbitrary iterators, you could implement
default like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.flask.OctoPrintSessionInterface">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">OctoPrintSessionInterface</span></code><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintSessionInterface" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="octoprint.server.util.flask.OctoPrintSessionInterface.save_session">
<code class="sig-name descname"><span class="pre">save_session</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintSessionInterface.save_session" title="Permalink to this definition">¶</a></dt>
<dd><p>This is called for actual sessions returned by <code class="xref py py-meth docutils literal notranslate"><span class="pre">open_session()</span></code>
at the end of the request.  This is still called during a request
context so if you absolutely need access to the request you can do
that.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.flask.OctoPrintSessionInterface.should_set_cookie">
<code class="sig-name descname"><span class="pre">should_set_cookie</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintSessionInterface.should_set_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Used by session backends to determine if a <code class="docutils literal notranslate"><span class="pre">Set-Cookie</span></code> header
should be set for this session cookie for this response. If the session
has been modified, the cookie is set. If the session is permanent and
the <code class="docutils literal notranslate"><span class="pre">SESSION_REFRESH_EACH_REQUEST</span></code> config is true, the cookie is
always set.</p>
<p>This check is usually skipped if the session was deleted.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.11.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.flask.PluginAssetResolver">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">PluginAssetResolver</span></code><a class="headerlink" href="#octoprint.server.util.flask.PluginAssetResolver" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="octoprint.server.util.flask.PluginAssetResolver.resolve_output_to_path">
<code class="sig-name descname"><span class="pre">resolve_output_to_path</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bundle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.PluginAssetResolver.resolve_output_to_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Given <code class="docutils literal notranslate"><span class="pre">target</span></code>, this has to return the absolute
filesystem path to which the output file of <code class="docutils literal notranslate"><span class="pre">bundle</span></code>
should be written.</p>
<p><code class="docutils literal notranslate"><span class="pre">target</span></code> may be a relative or absolute path, and is
usually taking from the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Bundle.output</span></code> property.</p>
<p>If a version-placeholder is used (<code class="docutils literal notranslate"><span class="pre">%(version)s</span></code>, it is
still unresolved at this point.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.flask.PluginAssetResolver.split_prefix">
<code class="sig-name descname"><span class="pre">split_prefix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.PluginAssetResolver.split_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>See if <code class="docutils literal notranslate"><span class="pre">item</span></code> has blueprint prefix, return (directory, rel_path).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.flask.SettingsCheckUpdater">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">SettingsCheckUpdater</span></code><a class="headerlink" href="#octoprint.server.util.flask.SettingsCheckUpdater" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="octoprint.server.util.flask.SettingsCheckUpdater.build_done">
<code class="sig-name descname"><span class="pre">build_done</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bundle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.SettingsCheckUpdater.build_done" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be called once a bundle has been successfully built.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.flask.SettingsCheckUpdater.needs_rebuild">
<code class="sig-name descname"><span class="pre">needs_rebuild</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bundle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.SettingsCheckUpdater.needs_rebuild" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the given bundle needs to be rebuilt,
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.flask.firstrun_only_access">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">firstrun_only_access</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.firstrun_only_access" title="Permalink to this definition">¶</a></dt>
<dd><p>If you decorate a view with this, it will ensure that first setup has _not_ been
done for OctoPrint’s Access Control. Otherwise it
will cause a HTTP 403 status code to be returned by the decorated resource.</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.flask.get_flask_user_from_request">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">get_flask_user_from_request</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.get_flask_user_from_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the current flask user from the request context. Uses API key if available, otherwise the current
user session if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> – flask request from which to retrieve the current user</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the user (might be an anonymous user)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.flask.make_api_error">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">make_api_error</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.make_api_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to generate API error responses in JSON format.</p>
<p>Turns something like <code class="docutils literal notranslate"><span class="pre">make_api_error(&quot;Not</span> <span class="pre">Found&quot;,</span> <span class="pre">404)</span></code> into a JSON response
with body <code class="docutils literal notranslate"><span class="pre">{&quot;error&quot;:</span> <span class="pre">&quot;Not</span> <span class="pre">Found&quot;}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> – The error message to put into the response</p></li>
<li><p><strong>status</strong> – The HTTP status code</p></li>
</ul>
</dd>
</dl>
<p>Returns: a flask response to return to the client</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.flask.make_text_response">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">make_text_response</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.make_text_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to generate basic text responses.</p>
<p>Response will have the provided message as body, the provided status code, and
a content type of “text/plain”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> – The message in the response body</p></li>
<li><p><strong>status</strong> – The HTTP status code</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.flask.no_firstrun_access">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">no_firstrun_access</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.no_firstrun_access" title="Permalink to this definition">¶</a></dt>
<dd><p>If you decorate a view with this, it will ensure that first setup has been
done for OctoPrint’s Access Control.</p>
<p>If OctoPrint’s Access Control has not been setup yet (indicated by the userManager
not reporting that its user database has been customized from default), the decorator
will cause a HTTP 403 status code to be returned by the decorated resource.</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.flask.permission_validator">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">permission_validator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permission</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.permission_validator" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates that the given request is made by an authorized user, identified either by API key or existing Flask
session.</p>
<p>Must be executed in an existing Flask request context!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> – The Flask request object</p></li>
<li><p><strong>request</strong> – The required permission</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.flask.redirect_to_tornado">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">redirect_to_tornado</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">code</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">302</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.redirect_to_tornado" title="Permalink to this definition">¶</a></dt>
<dd><p>Redirects from flask to tornado, flask request context must exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> – </p></li>
<li><p><strong>target</strong> – </p></li>
<li><p><strong>code</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.flask.restricted_access">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.flask.</span></code><code class="sig-name descname"><span class="pre">restricted_access</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.restricted_access" title="Permalink to this definition">¶</a></dt>
<dd><p>This combines <a class="reference internal" href="#octoprint.server.util.flask.no_firstrun_access" title="octoprint.server.util.flask.no_firstrun_access"><code class="xref py py-func docutils literal notranslate"><span class="pre">no_firstrun_access()</span></code></a> and <code class="docutils literal notranslate"><span class="pre">login_required</span></code>.</p>
</dd></dl>

</div>
<div class="section" id="module-octoprint.server.util.sockjs">
<span id="octoprint-server-util-sockjs"></span><span id="sec-modules-server-util-sockjs"></span><h1>octoprint.server.util.sockjs<a class="headerlink" href="#module-octoprint.server.util.sockjs" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="octoprint.server.util.sockjs.ThreadSafeSession">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.sockjs.</span></code><code class="sig-name descname"><span class="pre">ThreadSafeSession</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">server</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expiry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.sockjs.ThreadSafeSession" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="octoprint.server.util.sockjs.ThreadSafeSession.remove_handler">
<code class="sig-name descname"><span class="pre">remove_handler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handler</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.sockjs.ThreadSafeSession.remove_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Detach active handler from the session</p>
<dl class="simple">
<dt><cite>handler</cite></dt><dd><p>Handler to remove</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.sockjs.ThreadSafeSession.set_handler">
<code class="sig-name descname"><span class="pre">set_handler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_heartbeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.sockjs.ThreadSafeSession.set_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Set active handler for the session</p>
<dl class="simple">
<dt><cite>handler</cite></dt><dd><p>Associate active Tornado handler with the session</p>
</dd>
<dt><cite>start_heartbeat</cite></dt><dd><p>Should session start heartbeat immediately</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-octoprint.server.util.tornado">
<span id="octoprint-server-util-tornado"></span><span id="sec-modules-server-util-tornado"></span><h1>octoprint.server.util.tornado<a class="headerlink" href="#module-octoprint.server.util.tornado" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="octoprint.server.util.tornado.CorsSupportMixin">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">CorsSupportMixin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.web.Application</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.httputil.HTTPServerRequest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CorsSupportMixin" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/web.html#request-handlers">tornado.web.RequestHandler</a> mixin that
makes sure to set CORS headers similarly to the Flask backed API endpoints.</p>
<dl class="py method">
<dt id="octoprint.server.util.tornado.CorsSupportMixin.set_default_headers">
<code class="sig-name descname"><span class="pre">set_default_headers</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CorsSupportMixin.set_default_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Override this to set HTTP headers at the beginning of the request.</p>
<p>For example, this is the place to set a custom <code class="docutils literal notranslate"><span class="pre">Server</span></code> header.
Note that setting such headers in the normal flow of request
processing may not do what you want, since headers may be reset
during error handling.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.CustomHTTP1Connection">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">CustomHTTP1Connection</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CustomHTTP1Connection" title="Permalink to this definition">¶</a></dt>
<dd><p>A custom implementation of <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1Connection</span></code> which upon checking the <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> of
the request against the configured maximum utilizes <code class="docutils literal notranslate"><span class="pre">max_body_sizes</span></code> and <code class="docutils literal notranslate"><span class="pre">default_max_body_size</span></code> as a fallback.</p>
</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.CustomHTTP1ConnectionParameters">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">CustomHTTP1ConnectionParameters</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CustomHTTP1ConnectionParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>An implementation of <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1ConnectionParameters</span></code> that adds two new parameters
<code class="docutils literal notranslate"><span class="pre">max_body_sizes</span></code> and <code class="docutils literal notranslate"><span class="pre">default_max_body_size</span></code>.</p>
<p>For a description of these please see the documentation of <code class="docutils literal notranslate"><span class="pre">CustomHTTPServer</span></code> above.</p>
</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.CustomHTTP1ServerConnection">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">CustomHTTP1ServerConnection</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.iostream.IOStream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tornado.http1connection.HTTP1ConnectionParameters</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><span class="pre">object</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CustomHTTP1ServerConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>A custom implementation of <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1ServerConnection</span></code> which utilizes a <code class="docutils literal notranslate"><span class="pre">CustomHTTP1Connection</span></code>
instead of a <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1Connection</span></code> in <code class="docutils literal notranslate"><span class="pre">_server_request_loop</span></code>. The implementation logic is
otherwise the same as <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1ServerConnection</span></code>.</p>
</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.CustomHTTPServer">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">CustomHTTPServer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CustomHTTPServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom implementation of <code class="docutils literal notranslate"><span class="pre">tornado.httpserver.HTTPServer</span></code> that allows defining max body sizes depending on path and
method.</p>
<p>The implementation is mostly taken from <code class="docutils literal notranslate"><span class="pre">tornado.httpserver.HTTPServer</span></code>, the only difference is the creation
of a <code class="docutils literal notranslate"><span class="pre">CustomHTTP1ConnectionParameters</span></code> instance instead of <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1ConnectionParameters</span></code>
which is supplied with the two new constructor arguments <code class="docutils literal notranslate"><span class="pre">max_body_sizes</span></code> and <code class="docutils literal notranslate"><span class="pre">max_default_body_size</span></code> and the
creation of a <code class="docutils literal notranslate"><span class="pre">CustomHTTP1ServerConnection</span></code> instead of a <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1ServerConnection</span></code> upon
connection by a client.</p>
<p><code class="docutils literal notranslate"><span class="pre">max_body_sizes</span></code> is expected to be an iterable containing tuples of the form (method, path regex, maximum body size),
with method and path regex having to match in order for maximum body size to take affect.</p>
<p><code class="docutils literal notranslate"><span class="pre">default_max_body_size</span></code> is the default maximum body size to apply if no specific one from <code class="docutils literal notranslate"><span class="pre">max_body_sizes</span></code> matches.</p>
<dl class="py method">
<dt id="octoprint.server.util.tornado.CustomHTTPServer.handle_stream">
<code class="sig-name descname"><span class="pre">handle_stream</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">address</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CustomHTTPServer.handle_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to handle a new <cite>.IOStream</cite> from an incoming connection.</p>
<p>This method may be a coroutine; if so any exceptions it raises
asynchronously will be logged. Accepting of incoming connections
will not be blocked by this coroutine.</p>
<p>If this <cite>TCPServer</cite> is configured for SSL, <code class="docutils literal notranslate"><span class="pre">handle_stream</span></code>
may be called before the SSL handshake has completed. Use
<cite>.SSLIOStream.wait_for_handshake</cite> if you need to verify the client’s
certificate or use NPN/ALPN.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 4.2: </span>Added the option for this method to be a coroutine.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.DeprecatedEndpointHandler">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">DeprecatedEndpointHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.web.Application</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.httputil.HTTPServerRequest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.DeprecatedEndpointHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/web.html#request-handlers">tornado.web.RequestHandler</a> that redirects
to another <code class="docutils literal notranslate"><span class="pre">url</span></code> and logs a deprecation warning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>url</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – URL to which to redirect</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.DynamicZipBundleHandler">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">DynamicZipBundleHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.web.Application</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.httputil.HTTPServerRequest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.DynamicZipBundleHandler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.GlobalHeaderTransform">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">GlobalHeaderTransform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.GlobalHeaderTransform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.LargeResponseHandler">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">LargeResponseHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.web.Application</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.httputil.HTTPServerRequest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Customized <a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/web.html#tornado.web.StaticFileHandler">tornado.web.StaticFileHandler</a>
that allows delivery of the requested resource as attachment and access and request path validation through
optional callbacks. Note that access validation takes place before path validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The system path from which to serve files (this will be forwarded to the <code class="docutils literal notranslate"><span class="pre">initialize</span></code> method of
:class:<code class="docutils literal notranslate"><span class="pre">~tornado.web.StaticFileHandler</span></code>)</p></li>
<li><p><strong>default_filename</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The default filename to serve if none is explicitly specified and the request references
a subdirectory of the served path (this will be forwarded to the <code class="docutils literal notranslate"><span class="pre">initialize</span></code> method of
:class:<code class="docutils literal notranslate"><span class="pre">~tornado.web.StaticFileHandler</span></code> as the <code class="docutils literal notranslate"><span class="pre">default_filename</span></code> keyword parameter). Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>as_attachment</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to serve requested files with <code class="docutils literal notranslate"><span class="pre">Content-Disposition:</span> <span class="pre">attachment</span></code> header (<code class="docutils literal notranslate"><span class="pre">True</span></code>)
or not. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>allow_client_caching</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to allow the client to cache (by not setting any <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> or
<code class="docutils literal notranslate"><span class="pre">Expires</span></code> headers on the response) or not.</p></li>
<li><p><strong>access_validation</strong> (<em>function</em>) – Callback to call in the <code class="docutils literal notranslate"><span class="pre">get</span></code> method to validate access to the resource. Will
be called with <code class="docutils literal notranslate"><span class="pre">self.request</span></code> as parameter which contains the full tornado request object. Should raise
a <code class="docutils literal notranslate"><span class="pre">tornado.web.HTTPError</span></code> if access is not allowed in which case the request will not be further processed.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> and hence no access validation being performed.</p></li>
<li><p><strong>path_validation</strong> (<em>function</em>) – Callback to call in the <code class="docutils literal notranslate"><span class="pre">get</span></code> method to validate the requested path. Will be called
with the requested path as parameter. Should raise a <code class="docutils literal notranslate"><span class="pre">tornado.web.HTTPError</span></code> (e.g. an 404) if the requested
path does not pass validation in which case the request will not be further processed.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> and hence no path validation being performed.</p></li>
<li><p><strong>etag_generator</strong> (<em>function</em>) – Callback to call for generating the value of the ETag response header. Will be
called with the response handler as parameter. May return <code class="docutils literal notranslate"><span class="pre">None</span></code> to prevent the ETag response header
from being set. If not provided the last modified time of the file in question will be used as returned
by <code class="docutils literal notranslate"><span class="pre">get_content_version</span></code>.</p></li>
<li><p><strong>name_generator</strong> (<em>function</em>) – Callback to call for generating the value of the attachment file name header. Will be
called with the requested path as parameter.</p></li>
<li><p><strong>mime_type_guesser</strong> (<em>function</em>) – Callback to guess the mime type to use for the content type encoding of the
response. Will be called with the requested path on disk as parameter.</p></li>
<li><p><strong>is_pre_compressed</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if the file is expected to be pre-compressed, i.e, if there is a file in the same
directory with the same name, but with ‘.gz’ appended and gzip-encoded</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="octoprint.server.util.tornado.LargeResponseHandler.compute_etag">
<code class="sig-name descname"><span class="pre">compute_etag</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler.compute_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the etag header to be used for this request.</p>
<p>By default uses a hash of the content written so far.</p>
<p>May be overridden to provide custom etag implementations,
or may return None to disable tornado’s default etag support.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.LargeResponseHandler.get_content_type">
<code class="sig-name descname"><span class="pre">get_content_type</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler.get_content_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header to be used for this request.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.LargeResponseHandler.get_content_version">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">get_content_version</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abspath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler.get_content_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a version string for the resource at the given path.</p>
<p>This class method may be overridden by subclasses.  The
default implementation is a SHA-512 hash of the file’s contents.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.LargeResponseHandler.original_absolute_path">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">original_absolute_path</span></code><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler.original_absolute_path" title="Permalink to this definition">¶</a></dt>
<dd><p>The path of the uncompressed file corresponding to the compressed file</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.LargeResponseHandler.set_extra_headers">
<code class="sig-name descname"><span class="pre">set_extra_headers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler.set_extra_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>For subclass to add extra headers to the response</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.LargeResponseHandler.streamed_get">
<code class="sig-name descname"><span class="pre">streamed_get</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler.streamed_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Version of StaticFileHandler.get that doesn’t support ranges or ETag but streams the content. Helpful for files
that might still change while being transmitted (e.g. log files)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.RequestlessExceptionLoggingMixin">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">RequestlessExceptionLoggingMixin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.web.Application</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.httputil.HTTPServerRequest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.RequestlessExceptionLoggingMixin" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="octoprint.server.util.tornado.RequestlessExceptionLoggingMixin.log_exception">
<code class="sig-name descname"><span class="pre">log_exception</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">typ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.RequestlessExceptionLoggingMixin.log_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to customize logging of uncaught exceptions.</p>
<p>By default logs instances of <cite>HTTPError</cite> as warnings without
stack traces (on the <code class="docutils literal notranslate"><span class="pre">tornado.general</span></code> logger), and all
other exceptions as errors with stack traces (on the
<code class="docutils literal notranslate"><span class="pre">tornado.application</span></code> logger).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 3.1.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.StaticDataHandler">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">StaticDataHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.web.Application</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.httputil.HTTPServerRequest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.StaticDataHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/web.html#request-handlers">tornado.web.RequestHandler</a> that returns
static <code class="docutils literal notranslate"><span class="pre">data</span></code> of a configured <code class="docutils literal notranslate"><span class="pre">content_type</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The data with which to respond</p></li>
<li><p><strong>content_type</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The content type with which to respond. Defaults to <code class="docutils literal notranslate"><span class="pre">text/plain</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.StaticZipBundleHandler">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">StaticZipBundleHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.web.Application</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.httputil.HTTPServerRequest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.StaticZipBundleHandler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.SystemInfoBundleHandler">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">SystemInfoBundleHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.web.Application</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.httputil.HTTPServerRequest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.SystemInfoBundleHandler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">UploadStorageFallbackHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.web.Application</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.httputil.HTTPServerRequest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>A <code class="docutils literal notranslate"><span class="pre">RequestHandler</span></code> similar to <code class="docutils literal notranslate"><span class="pre">tornado.web.FallbackHandler</span></code> which fetches any files contained in the request bodies
of content type <code class="docutils literal notranslate"><span class="pre">multipart</span></code>, stores them in temporary files and supplies the <code class="docutils literal notranslate"><span class="pre">fallback</span></code> with the file’s <code class="docutils literal notranslate"><span class="pre">name</span></code>,
<code class="docutils literal notranslate"><span class="pre">content_type</span></code>, <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">size</span></code> instead via a rewritten body.</p>
<p>Basically similar to what the nginx upload module does.</p>
<p>Basic request body example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.gcode&quot;
Content-Type: application/octet-stream

...
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;apikey&quot;

my_funny_apikey
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;select&quot;

true
------WebKitFormBoundarypYiSUx63abAmhT5C--
</pre></div>
</div>
<p>That would get turned into:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;apikey&quot;

my_funny_apikey
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;select&quot;

true
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;file.path&quot;
Content-Type: text/plain; charset=utf-8

/tmp/tmpzupkro
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;file.name&quot;
Content-Type: text/plain; charset=utf-8

test.gcode
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;file.content_type&quot;
Content-Type: text/plain; charset=utf-8

application/octet-stream
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;file.size&quot;
Content-Type: text/plain; charset=utf-8

349182
------WebKitFormBoundarypYiSUx63abAmhT5C--
</pre></div>
</div>
<p>The underlying application can then access the contained files via their respective paths and just move them
where necessary.</p>
<dl class="py attribute">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.BODY_METHODS">
<code class="sig-name descname"><span class="pre">BODY_METHODS</span></code><em class="property"> <span class="pre">=</span> <span class="pre">('POST',</span> <span class="pre">'PATCH',</span> <span class="pre">'PUT')</span></em><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.BODY_METHODS" title="Permalink to this definition">¶</a></dt>
<dd><p>The request methods that may contain a request body.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.data_received">
<code class="sig-name descname"><span class="pre">data_received</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunk</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.data_received" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by Tornado on receiving a chunk of the request body. If request is a multipart request, takes care of
processing the multipart data structure via <code class="xref py py-func docutils literal notranslate"><span class="pre">_process_multipart_data()</span></code>. If not, just adds the chunk to
internal in-memory buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chunk</strong> – chunk of data received from Tornado</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.delete">
<code class="sig-name descname"><span class="pre">delete</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.get">
<code class="sig-name descname"><span class="pre">get</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.head">
<code class="sig-name descname"><span class="pre">head</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.head" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.is_multipart">
<code class="sig-name descname"><span class="pre">is_multipart</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.is_multipart" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether this request is a <code class="docutils literal notranslate"><span class="pre">multipart</span></code> request</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.options">
<code class="sig-name descname"><span class="pre">options</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.patch">
<code class="sig-name descname"><span class="pre">patch</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.post">
<code class="sig-name descname"><span class="pre">post</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.prepare">
<code class="sig-name descname"><span class="pre">prepare</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the processing of the request. If it’s a request that may contain a request body (as defined in
<a class="reference internal" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.BODY_METHODS" title="octoprint.server.util.tornado.UploadStorageFallbackHandler.BODY_METHODS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">UploadStorageFallbackHandler.BODY_METHODS</span></code></a>) prepares the multipart parsing if content type fits. If it’s a
body-less request, just calls the <code class="docutils literal notranslate"><span class="pre">fallback</span></code> with an empty body and finishes the request.</p>
</dd></dl>

<dl class="py method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.put">
<code class="sig-name descname"><span class="pre">put</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.put" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.UrlProxyHandler">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">UrlProxyHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">application</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.web.Application</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tornado.httputil.HTTPServerRequest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UrlProxyHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/web.html#request-handlers">tornado.web.RequestHandler</a> that proxies
requests to a preconfigured url and returns the response. Allows delivery of the requested content as attachment
and access validation through an optional callback.</p>
<p>This will use <a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/httpclient.html#tornado.httpclient.AsyncHTTPClient">tornado.httpclient.AsyncHTTPClient</a>
for making the request to the configured endpoint and return the body of the client response with the status code
from the client response and the following headers:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Date</span></code>, <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code>, <code class="docutils literal notranslate"><span class="pre">Expires</span></code>, <code class="docutils literal notranslate"><span class="pre">ETag</span></code>, <code class="docutils literal notranslate"><span class="pre">Server</span></code>, <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> and <code class="docutils literal notranslate"><span class="pre">Location</span></code> will be copied over.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">as_attachment</span></code> is set to True, <code class="docutils literal notranslate"><span class="pre">Content-Disposition</span></code> will be set to <code class="docutils literal notranslate"><span class="pre">attachment</span></code>. If <code class="docutils literal notranslate"><span class="pre">basename</span></code> is
set including the attachment’s <code class="docutils literal notranslate"><span class="pre">filename</span></code> attribute will be set to the base name followed by the extension
guessed based on the MIME type from the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header of the response. If no extension can be guessed
no <code class="docutils literal notranslate"><span class="pre">filename</span></code> attribute will be set.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – URL to forward any requests to. A 404 response will be returned if this is not set. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>as_attachment</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to serve files with <code class="docutils literal notranslate"><span class="pre">Content-Disposition:</span> <span class="pre">attachment</span></code> header (<code class="docutils literal notranslate"><span class="pre">True</span></code>)
or not. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>basename</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – base name of file names to return as part of the attachment header, see above. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>access_validation</strong> (<em>function</em>) – Callback to call in the <code class="docutils literal notranslate"><span class="pre">get</span></code> method to validate access to the resource. Will
be called with <code class="docutils literal notranslate"><span class="pre">self.request</span></code> as parameter which contains the full tornado request object. Should raise
a <code class="docutils literal notranslate"><span class="pre">tornado.web.HTTPError</span></code> if access is not allowed in which case the request will not be further processed.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> and hence no access validation being performed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="octoprint.server.util.tornado.WsgiInputContainer">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">WsgiInputContainer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wsgi_application</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forced_headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">removed_headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.WsgiInputContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>A WSGI container for use with Tornado that allows supplying the request body to be used for <code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code> in the
generated WSGI environment upon call.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">RequestHandler</span></code> can thus provide the WSGI application with a stream for the request body, or a modified body.</p>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">octoprint</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">WsgiInputContainer</span><span class="p">(</span><span class="n">octoprint_app</span><span class="p">)</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*&quot;</span><span class="p">,</span> <span class="n">UploadStorageFallbackHandler</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fallback</span><span class="o">=</span><span class="n">wsgi_app</span><span class="p">),</span>
<span class="p">])</span>
</pre></div>
</div>
<p>The implementation logic is basically the same as <code class="docutils literal notranslate"><span class="pre">tornado.wsgi.WSGIContainer</span></code> but the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> and <code class="docutils literal notranslate"><span class="pre">environ</span></code>
methods have been adjusted to allow for an optionally supplied <code class="docutils literal notranslate"><span class="pre">body</span></code> argument which is then used for <code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code>.</p>
<dl class="py method">
<dt id="octoprint.server.util.tornado.WsgiInputContainer.environ">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">environ</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.WsgiInputContainer.environ" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a <code class="docutils literal notranslate"><span class="pre">tornado.httputil.HTTPServerRequest</span></code> to a WSGI environment.</p>
<p>An optional <code class="docutils literal notranslate"><span class="pre">body</span></code> to be used for populating <code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code> can be supplied (either a string or a stream). If not
supplied, <code class="docutils literal notranslate"><span class="pre">request.body</span></code> will be wrapped into a <code class="docutils literal notranslate"><span class="pre">io.BytesIO</span></code> stream and used instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> – the <code class="docutils literal notranslate"><span class="pre">tornado.httpserver.HTTPServerRequest</span></code> to derive the WSGI environment from</p></li>
<li><p><strong>body</strong> – an optional body  to use as <code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code> instead of <code class="docutils literal notranslate"><span class="pre">request.body</span></code>, can be a string or a stream</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.tornado.access_validation_factory">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">access_validation_factory</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validator</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.access_validation_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an access validation wrapper using the supplied validator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>validator</strong> – the access validator to use inside the validation wrapper</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an access validator taking a request as parameter and performing the request validation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.tornado.fix_json_encode">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">fix_json_encode</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.fix_json_encode" title="Permalink to this definition">¶</a></dt>
<dd><p>This makes tornado.escape.json_encode use octoprint.util.JsonEncoding.encode as fallback in order to allow
serialization of globally registered types like frozendict and others.</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.tornado.fix_websocket_check_origin">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">fix_websocket_check_origin</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.fix_websocket_check_origin" title="Permalink to this definition">¶</a></dt>
<dd><p>This fixes tornado.websocket.WebSocketHandler.check_origin to do the same origin check against the Host
header case-insensitively, as defined in RFC6454, Section 4, item 5.</p>
</dd></dl>

<dl class="py function">
<dt id="octoprint.server.util.tornado.path_validation_factory">
<code class="sig-prename descclassname"><span class="pre">octoprint.server.util.tornado.</span></code><code class="sig-name descname"><span class="pre">path_validation_factory</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status_code</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">404</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.path_validation_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a request path validation wrapper returning the defined status code if the supplied path_filter returns False.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path_filter</strong> – the path filter to use on the requested path, should return False for requests that should
be responded with the provided error code.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a request path validator taking a request path as parameter and performing the request validation</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="settings.html" class="btn btn-neutral float-right" title="octoprint.settings" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="printer.html" class="btn btn-neutral float-left" title="octoprint.printer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2013-2021, Gina Häußge.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: maintenance
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="https://docs.octoprint.org/en/1.5.3/modules/server.html">1.5.3</a></dd>
      <dd><a href="https://docs.octoprint.org/en/1.6.1/modules/server.html">1.6.1</a></dd>
      <dd><a href="https://docs.octoprint.org/en/1.7.0rc2/modules/server.html">1.7.0rc2</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="https://docs.octoprint.org/en/master/modules/server.html">master</a></dd>
      <dd><a href="https://docs.octoprint.org/en/maintenance/modules/server.html">maintenance</a></dd>
      <dd><a href="https://docs.octoprint.org/en/devel/modules/server.html">devel</a></dd>
    </dl>
  </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>