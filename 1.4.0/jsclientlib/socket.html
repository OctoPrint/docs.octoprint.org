

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OctoPrintClient.socket &mdash; OctoPrint 1.4.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="https://unpkg.com/mermaid@8.4.8/dist/mermaid.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="OctoPrintClient.system" href="system.html" />
    <link rel="prev" title="OctoPrintClient.slicing" href="slicing.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> OctoPrint
          

          
          </a>

          
            
            
              <div class="version">
                1.4.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bundledplugins/index.html">Bundled Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../events/index.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Developing Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">Internal Modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">JavaScript Client Library</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="base.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="browser.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.browser</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="connection.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.connection</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="control.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="files.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.files</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="job.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.job</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="languages.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.languages</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="logs.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.logs</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="printer.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.printer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="printerprofiles.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.printerprofiles</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="settings.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.settings</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="slicing.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.slicing</span></code></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.socket</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#communication-throttling">Communication Throttling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="system.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.system</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="timelapse.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.timelapse</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.users</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="util.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.util</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="wizard.html"><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.wizard</span></code></a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OctoPrint</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">



  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">JavaScript Client Library</a> &raquo;</li>
        
      <li><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.socket</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/jsclientlib/socket.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="octoprintclient-socket">
<span id="sec-jsclientlib-socket"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">OctoPrintClient.socket</span></code><a class="headerlink" href="#octoprintclient-socket" title="Permalink to this headline">¶</a></h1>
<dl class="attribute">
<dt id="OctoPrintClient.socket.options">
<code class="descclassname">OctoPrintClient.socket.</code><code class="descname">options</code><a class="headerlink" href="#OctoPrintClient.socket.options" title="Permalink to this definition">¶</a></dt>
<dd><p>The socket client’s options.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.socket.options.timeouts</span></code></dt>
<dd>A list of consecutive timeouts after which to attempt reconnecting to a
disconnected sockets, in seconds. Defaults to <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">8,</span> <span class="pre">13,</span> <span class="pre">20,</span> <span class="pre">40,</span> <span class="pre">100]</span></code>.
The default setting here makes the client slowly back off after the first couple of very
fast connection attempts don’t succeed, and give up after 10 tries.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">OctoPrintClient.socket.options.rateSlidingWindowSize</span></code></dt>
<dd>Number of last rate measurements to take into account for timing analysis and
communication throttling. See <a class="reference internal" href="#sec-jsclient-socket-throttling"><span class="std std-ref">Communication Throttling</span></a>
below.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="OctoPrintClient.socket.connect">
<code class="descclassname">OctoPrintClient.socket.</code><code class="descname">connect</code><span class="sig-paren">(</span><em>opts</em><span class="sig-paren">)</span><a class="headerlink" href="#OctoPrintClient.socket.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects the socket client to OctoPrint’s <a class="reference external" href="http://sockjs.org/">SockJS</a> socket.</p>
<p>The optional parameter <code class="docutils literal notranslate"><span class="pre">opts</span></code> may be used to provide additional configuration options
to the SockJS constructor. See the <a class="reference external" href="https://github.com/sockjs/sockjs-client#sockjs-class">SockJS documentation</a> on potential options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first last simple">
<li><strong>opts</strong> (<em>object</em>) – Additional options for the SockJS constructor.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="OctoPrintClient.socket.reconnect">
<code class="descclassname">OctoPrintClient.socket.</code><code class="descname">reconnect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#OctoPrintClient.socket.reconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconnects the socket client. If the socket is currently connected it will be disconnected first.</p>
</dd></dl>

<dl class="function">
<dt id="OctoPrintClient.socket.disconnect">
<code class="descclassname">OctoPrintClient.socket.</code><code class="descname">disconnect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#OctoPrintClient.socket.disconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Disconnects the socket client.</p>
</dd></dl>

<dl class="function">
<dt id="OctoPrintClient.socket.onMessage">
<code class="descclassname">OctoPrintClient.socket.</code><code class="descname">onMessage</code><span class="sig-paren">(</span><em>message</em>, <em>handler</em><span class="sig-paren">)</span><a class="headerlink" href="#OctoPrintClient.socket.onMessage" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers the <code class="docutils literal notranslate"><span class="pre">handler</span></code> for messages of type <code class="docutils literal notranslate"><span class="pre">message</span></code>.</p>
<p>To register for all message types, provide <code class="docutils literal notranslate"><span class="pre">*</span></code> as the type to register for.</p>
<p><code class="docutils literal notranslate"><span class="pre">handler</span></code> is expected to be a function accepting one object parameter <code class="docutils literal notranslate"><span class="pre">eventObj</span></code>, consisting
of the received message as property <code class="docutils literal notranslate"><span class="pre">event</span></code> and the received payload (if any) as property <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">OctoPrint</span><span class="p">.</span><span class="nx">socket</span><span class="p">.</span><span class="nx">onMessage</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do something with the message object</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The socket client will measure how long message processing over all handlers will take and utilize
that measurement to determine if the <a class="reference internal" href="#sec-jsclient-socket-throttling"><span class="std std-ref">communication throttling</span></a>
needs to be adjusted or not.</p>
<p>Please refer to the <a class="reference internal" href="../api/push.html#sec-api-push"><span class="std std-ref">Push API documentation</span></a>
for details on the possible message types and their payloads.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> (<em>string</em>) – The type of message for which to register</li>
<li><strong>handler</strong> (<em>function</em>) – The handler function</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="OctoPrintClient.socket.sendMessage">
<code class="descclassname">OctoPrintClient.socket.</code><code class="descname">sendMessage</code><span class="sig-paren">(</span><em>type</em>, <em>payload</em><span class="sig-paren">)</span><a class="headerlink" href="#OctoPrintClient.socket.sendMessage" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a message of type <code class="docutils literal notranslate"><span class="pre">type</span></code> with the provided <code class="docutils literal notranslate"><span class="pre">payload</span></code> to the server.</p>
<p>Note that at the time of writing, OctoPrint only supports the <code class="docutils literal notranslate"><span class="pre">throttle</span></code> message. See
also the <a class="reference internal" href="../api/push.html#sec-api-push"><span class="std std-ref">Push API documentation</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first last simple">
<li><strong>type</strong> (<em>string</em>) – Type of message to send</li>
<li><strong>payload</strong> (<em>object</em>) – Payload to send</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="OctoPrintClient.socket.onRateTooLow">
<code class="descclassname">OctoPrintClient.socket.</code><code class="descname">onRateTooLow</code><span class="sig-paren">(</span><em>measured</em>, <em>minimum</em><span class="sig-paren">)</span><a class="headerlink" href="#OctoPrintClient.socket.onRateTooLow" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the socket client when the measured message round trip times have been lower than
the current lower processing limit over the full sliding window, indicating that messages
are now processed faster than the current rate and a faster rate might be possible.</p>
<p>Can be overwritten with custom handler methods. The default implementation will call
<code class="xref js js-func docutils literal notranslate"><span class="pre">OctoPrint.socket.increaseRate()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first last simple">
<li><strong>measured</strong> (<em>Number</em>) – Maximal measured message round trip time</li>
<li><strong>minimum</strong> (<em>Number</em>) – Lower round trip time limit for keeping the rate</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="OctoPrintClient.socket.onRateTooHigh">
<code class="descclassname">OctoPrintClient.socket.</code><code class="descname">onRateTooHigh</code><span class="sig-paren">(</span><em>measured</em>, <em>maximum</em><span class="sig-paren">)</span><a class="headerlink" href="#OctoPrintClient.socket.onRateTooHigh" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the socket client when the last measured round trip time was higher than the
current upper processing limit, indicating that the messages are now processed slower than
the current rate requires and a slower rate might be necessary.</p>
<p>Can be overwritten with custom handler methods. The default implementation will call
<code class="xref js js-func docutils literal notranslate"><span class="pre">OctoPrint.socket.decreaseRate()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first last simple">
<li><strong>measured</strong> (<em>Number</em>) – Measured message round trip time</li>
<li><strong>minimum</strong> (<em>Number</em>) – Upper round trip time limit for keeping the rate</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="OctoPrintClient.socket.increaseRate">
<code class="descclassname">OctoPrintClient.socket.</code><code class="descname">increaseRate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#OctoPrintClient.socket.increaseRate" title="Permalink to this definition">¶</a></dt>
<dd><p>Instructs the server to increase the message rate by 500ms.</p>
</dd></dl>

<dl class="function">
<dt id="OctoPrintClient.socket.decreaseRate">
<code class="descclassname">OctoPrintClient.socket.</code><code class="descname">decreaseRate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#OctoPrintClient.socket.decreaseRate" title="Permalink to this definition">¶</a></dt>
<dd><p>Instructs the server to decrease the message rate by 500ms.</p>
</dd></dl>

<div class="section" id="communication-throttling">
<span id="sec-jsclient-socket-throttling"></span><h2>Communication Throttling<a class="headerlink" href="#communication-throttling" title="Permalink to this headline">¶</a></h2>
<p>The socket client supports communication throttling. It will measure how long each incoming message takes
to be processed by all registered handlers. If the processing times in a sliding window are longer than
the current rate limit configured on the socket (default: 500ms between messages), the socket client will
instruct the server to send slower. If the messages are handled faster than half the current rate limit,
the socket client will instruct the server to send faster.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="system.html" class="btn btn-neutral float-right" title="OctoPrintClient.system" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="slicing.html" class="btn btn-neutral float-left" title="OctoPrintClient.slicing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2020, Gina Häußge

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: 1.4.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="https://docs.octoprint.org/en/1.3.12/jsclientlib/socket.html">1.3.12</a></dd>
      <dd><a href="https://docs.octoprint.org/en/1.4.0/jsclientlib/socket.html">1.4.0</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="https://docs.octoprint.org/en/master/jsclientlib/socket.html">master</a></dd>
      <dd><a href="https://docs.octoprint.org/en/maintenance/jsclientlib/socket.html">maintenance</a></dd>
      <dd><a href="https://docs.octoprint.org/en/devel/jsclientlib/socket.html">devel</a></dd>
    </dl>
  </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>