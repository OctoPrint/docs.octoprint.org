

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>octoprint.server &mdash; OctoPrint 1.4.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="https://unpkg.com/mermaid@8.4.8/dist/mermaid.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="octoprint.settings" href="settings.html" />
    <link rel="prev" title="octoprint.printer" href="printer.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> OctoPrint
          

          
          </a>

          
            
            
              <div class="version">
                1.4.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bundledplugins/index.html">Bundled Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../events/index.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Developing Plugins</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Internal Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cli.html">octoprint.cli</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#module-octoprint.cli.dev">octoprint.cli.dev</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#module-octoprint.cli.plugins">octoprint.cli.plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#module-octoprint.cli.server">octoprint.cli.server</a></li>
<li class="toctree-l2"><a class="reference internal" href="filemanager.html">octoprint.filemanager</a></li>
<li class="toctree-l2"><a class="reference internal" href="filemanager.html#module-octoprint.filemanager.analysis">octoprint.filemanager.analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="filemanager.html#module-octoprint.filemanager.destinations">octoprint.filemanager.destinations</a></li>
<li class="toctree-l2"><a class="reference internal" href="filemanager.html#module-octoprint.filemanager.storage">octoprint.filemanager.storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="filemanager.html#module-octoprint.filemanager.util">octoprint.filemanager.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin.html">octoprint.plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin.html#module-octoprint.plugin.core">octoprint.plugin.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin.html#module-octoprint.plugin.types">octoprint.plugin.types</a></li>
<li class="toctree-l2"><a class="reference internal" href="printer.html">octoprint.printer</a></li>
<li class="toctree-l2"><a class="reference internal" href="printer.html#module-octoprint.printer.profile">octoprint.printer.profile</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">octoprint.server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-octoprint.server.util">octoprint.server.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-octoprint.server.util.flask">octoprint.server.util.flask</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-octoprint.server.util.sockjs">octoprint.server.util.sockjs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-octoprint.server.util.tornado">octoprint.server.util.tornado</a></li>
<li class="toctree-l2"><a class="reference internal" href="settings.html">octoprint.settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="slicing.html">octoprint.slicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="slicing.html#module-octoprint.slicing.exceptions">octoprint.slicing.exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html">octoprint.access.users</a></li>
<li class="toctree-l2"><a class="reference internal" href="util.html">octoprint.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="util.html#module-octoprint.util.commandline">octoprint.util.commandline</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jsclientlib/index.html">JavaScript Client Library</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OctoPrint</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">



  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Internal Modules</a> &raquo;</li>
        
      <li>octoprint.server</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/modules/server.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-octoprint.server">
<span id="octoprint-server"></span><span id="sec-modules-server"></span><h1>octoprint.server<a class="headerlink" href="#module-octoprint.server" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="module-octoprint.server.util">
<span id="octoprint-server-util"></span><span id="sec-modules-server-util"></span><h1>octoprint.server.util<a class="headerlink" href="#module-octoprint.server.util" title="Permalink to this headline">¶</a></h1>
<dl class="exception">
<dt id="octoprint.server.util.InvalidApiKeyException">
<em class="property">exception </em><code class="descclassname">octoprint.server.util.</code><code class="descname">InvalidApiKeyException</code><a class="headerlink" href="#octoprint.server.util.InvalidApiKeyException" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="octoprint.server.util.corsRequestHandler">
<code class="descclassname">octoprint.server.util.</code><code class="descname">corsRequestHandler</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.corsRequestHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">before_request</span></code> handler for blueprints which sets CORS headers for OPTIONS requests if enabled</p>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.corsResponseHandler">
<code class="descclassname">octoprint.server.util.</code><code class="descname">corsResponseHandler</code><span class="sig-paren">(</span><em>resp</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.corsResponseHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">after_request</span></code> handler for blueprints for which CORS is supported.</p>
<p>Sets <code class="docutils literal notranslate"><span class="pre">Access-Control-Allow-Origin</span></code> headers for <code class="docutils literal notranslate"><span class="pre">Origin</span></code> request header on response.</p>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.loginFromApiKeyRequestHandler">
<code class="descclassname">octoprint.server.util.</code><code class="descname">loginFromApiKeyRequestHandler</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.loginFromApiKeyRequestHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">before_request</span></code> handler for blueprints which creates a login session for the provided api key (if available)</p>
<p>App session keys are handled as anonymous keys here and ignored.</p>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.loginFromAuthorizationHeaderRequestHandler">
<code class="descclassname">octoprint.server.util.</code><code class="descname">loginFromAuthorizationHeaderRequestHandler</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.loginFromAuthorizationHeaderRequestHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">before_request</span></code> handler for creating login sessions based on the Authorization header.</p>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.loginUser">
<code class="descclassname">octoprint.server.util.</code><code class="descname">loginUser</code><span class="sig-paren">(</span><em>user</em>, <em>remember=False</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.loginUser" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs the provided <code class="docutils literal notranslate"><span class="pre">user</span></code> into Flask Login and Principal if not None and active</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>user</strong> – the User to login. May be None in which case the login will fail</li>
<li><strong>remember</strong> – Whether to set the <code class="docutils literal notranslate"><span class="pre">remember</span></code> flag on the Flask Login operation</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: (bool) True if the login succeeded, False otherwise</p>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.noCachingExceptGetResponseHandler">
<code class="descclassname">octoprint.server.util.</code><code class="descname">noCachingExceptGetResponseHandler</code><span class="sig-paren">(</span><em>resp</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.noCachingExceptGetResponseHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">after_request</span></code> handler for blueprints which shall set no caching headers
on their responses to any requests that are not sent with method <code class="docutils literal notranslate"><span class="pre">GET</span></code>.</p>
<p>See <a class="reference internal" href="#octoprint.server.util.noCachingResponseHandler" title="octoprint.server.util.noCachingResponseHandler"><code class="xref py py-func docutils literal notranslate"><span class="pre">noCachingResponseHandler()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.noCachingResponseHandler">
<code class="descclassname">octoprint.server.util.</code><code class="descname">noCachingResponseHandler</code><span class="sig-paren">(</span><em>resp</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.noCachingResponseHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">after_request</span></code> handler for blueprints which shall set no caching headers
on their responses.</p>
<p>Sets <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code>, <code class="docutils literal notranslate"><span class="pre">Pragma</span></code> and <code class="docutils literal notranslate"><span class="pre">Expires</span></code> headers accordingly
to prevent all client side caching from taking place.</p>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.optionsAllowOrigin">
<code class="descclassname">octoprint.server.util.</code><code class="descname">optionsAllowOrigin</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.optionsAllowOrigin" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for request handling for CORS OPTIONS requests to set CORS headers.</p>
</dd></dl>

</div>
<div class="section" id="module-octoprint.server.util.flask">
<span id="octoprint-server-util-flask"></span><span id="sec-modules-server-util-flask"></span><h1>octoprint.server.util.flask<a class="headerlink" href="#module-octoprint.server.util.flask" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="octoprint.server.util.flask.LessSimpleCache">
<em class="property">class </em><code class="descclassname">octoprint.server.util.flask.</code><code class="descname">LessSimpleCache</code><span class="sig-paren">(</span><em>threshold=500</em>, <em>default_timeout=300</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.LessSimpleCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Slightly improved version of <code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleCache</span></code>.</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">default_timeout</span></code> or <code class="docutils literal notranslate"><span class="pre">timeout</span></code> to <code class="docutils literal notranslate"><span class="pre">-1</span></code> will have no timeout be applied at all.</p>
<dl class="method">
<dt id="octoprint.server.util.flask.LessSimpleCache.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>key</em>, <em>value</em>, <em>timeout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.LessSimpleCache.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Works like <a class="reference internal" href="#octoprint.server.util.flask.LessSimpleCache.set" title="octoprint.server.util.flask.LessSimpleCache.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set()</span></code></a> but does not overwrite the values of already
existing keys.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> – the key to set</li>
<li><strong>value</strong> – the value for the key</li>
<li><strong>timeout</strong> – the cache timeout for the key in seconds (if not
specified, it uses the default timeout). A timeout of
0 idicates that the cache never expires.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Same as <a class="reference internal" href="#octoprint.server.util.flask.LessSimpleCache.set" title="octoprint.server.util.flask.LessSimpleCache.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set()</span></code></a>, but also <code class="docutils literal notranslate"><span class="pre">False</span></code> for already
existing keys.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">boolean</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.flask.LessSimpleCache.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.LessSimpleCache.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete <cite>key</cite> from the cache.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> – the key to delete.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Whether the key existed and has been deleted.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">boolean</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.flask.LessSimpleCache.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.LessSimpleCache.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Look up key in the cache and return the value for it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> – the key to be looked up.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The value if it exists and is readable, else <code class="docutils literal notranslate"><span class="pre">None</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.flask.LessSimpleCache.set">
<code class="descname">set</code><span class="sig-paren">(</span><em>key</em>, <em>value</em>, <em>timeout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.LessSimpleCache.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new key/value to the cache (overwrites value, if key already
exists in the cache).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> – the key to set</li>
<li><strong>value</strong> – the value for the key</li>
<li><strong>timeout</strong> – the cache timeout for the key in seconds (if not
specified, it uses the default timeout). A timeout of
0 idicates that the cache never expires.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="docutils literal notranslate"><span class="pre">True</span></code> if key has been updated, <code class="docutils literal notranslate"><span class="pre">False</span></code> for backend
errors. Pickling errors, however, will raise a subclass of
<code class="docutils literal notranslate"><span class="pre">pickle.PickleError</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">boolean</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.flask.OctoPrintFlaskRequest">
<em class="property">class </em><code class="descclassname">octoprint.server.util.flask.</code><code class="descname">OctoPrintFlaskRequest</code><span class="sig-paren">(</span><em>environ</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskRequest" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="octoprint.server.util.flask.OctoPrintFlaskRequest.cookie_suffix">
<code class="descname">cookie_suffix</code><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskRequest.cookie_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Request specific suffix for set and read cookies</p>
<p>We need this because cookies are not port-specific and we don’t want to overwrite our
session and other cookies from one OctoPrint instance on our machine with those of another
one who happens to listen on the same address albeit a different port or script root.</p>
</dd></dl>

<dl class="attribute">
<dt id="octoprint.server.util.flask.OctoPrintFlaskRequest.server_name">
<code class="descname">server_name</code><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskRequest.server_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Short cut to the request’s server name header</p>
</dd></dl>

<dl class="attribute">
<dt id="octoprint.server.util.flask.OctoPrintFlaskRequest.server_port">
<code class="descname">server_port</code><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskRequest.server_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Short cut to the request’s server port header</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.flask.OctoPrintFlaskResponse">
<em class="property">class </em><code class="descclassname">octoprint.server.util.flask.</code><code class="descname">OctoPrintFlaskResponse</code><span class="sig-paren">(</span><em>response=None</em>, <em>status=None</em>, <em>headers=None</em>, <em>mimetype=None</em>, <em>content_type=None</em>, <em>direct_passthrough=False</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskResponse" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="octoprint.server.util.flask.OctoPrintFlaskResponse.delete_cookie">
<code class="descname">delete_cookie</code><span class="sig-paren">(</span><em>key</em>, <em>path='/'</em>, <em>domain=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskResponse.delete_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a cookie.  Fails silently if key doesn’t exist.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> – the key (name) of the cookie to be deleted.</li>
<li><strong>path</strong> – if the cookie that should be deleted was limited to a
path, the path has to be defined here.</li>
<li><strong>domain</strong> – if the cookie that should be deleted was limited to a
domain, that domain has to be defined here.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.flask.OctoPrintFlaskResponse.set_cookie">
<code class="descname">set_cookie</code><span class="sig-paren">(</span><em>key</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintFlaskResponse.set_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a cookie. The parameters are the same as in the cookie <cite>Morsel</cite>
object in the Python standard library but it accepts unicode data, too.</p>
<p>A warning is raised if the size of the cookie header exceeds
<code class="xref py py-attr docutils literal notranslate"><span class="pre">max_cookie_size</span></code>, but the header will still be set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> – the key (name) of the cookie to be set.</li>
<li><strong>value</strong> – the value of the cookie.</li>
<li><strong>max_age</strong> – should be a number of seconds, or <cite>None</cite> (default) if
the cookie should last only as long as the client’s
browser session.</li>
<li><strong>expires</strong> – should be a <cite>datetime</cite> object or UNIX timestamp.</li>
<li><strong>path</strong> – limits the cookie to a given path, per default it will
span the whole domain.</li>
<li><strong>domain</strong> – if you want to set a cross-domain cookie.  For example,
<code class="docutils literal notranslate"><span class="pre">domain=&quot;.example.com&quot;</span></code> will set a cookie that is
readable by the domain <code class="docutils literal notranslate"><span class="pre">www.example.com</span></code>,
<code class="docutils literal notranslate"><span class="pre">foo.example.com</span></code> etc.  Otherwise, a cookie will only
be readable by the domain that set it.</li>
<li><strong>secure</strong> – If <cite>True</cite>, the cookie will only be available via HTTPS</li>
<li><strong>httponly</strong> – disallow JavaScript to access the cookie.  This is an
extension to the cookie standard and probably not
supported by all browsers.</li>
<li><strong>samesite</strong> – Limits the scope of the cookie such that it will only
be attached to requests if those requests are
“same-site”.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.flask.OctoPrintJsonEncoder">
<em class="property">class </em><code class="descclassname">octoprint.server.util.flask.</code><code class="descname">OctoPrintJsonEncoder</code><span class="sig-paren">(</span><em>*</em>, <em>skipkeys=False</em>, <em>ensure_ascii=True</em>, <em>check_circular=True</em>, <em>allow_nan=True</em>, <em>sort_keys=False</em>, <em>indent=None</em>, <em>separators=None</em>, <em>default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintJsonEncoder" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="octoprint.server.util.flask.OctoPrintJsonEncoder.default">
<code class="descname">default</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintJsonEncoder.default" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement this method in a subclass such that it returns a
serializable object for <code class="docutils literal notranslate"><span class="pre">o</span></code>, or calls the base implementation (to
raise a <code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code>).</p>
<p>For example, to support arbitrary iterators, you could implement
default like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.flask.OctoPrintSessionInterface">
<em class="property">class </em><code class="descclassname">octoprint.server.util.flask.</code><code class="descname">OctoPrintSessionInterface</code><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintSessionInterface" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="octoprint.server.util.flask.OctoPrintSessionInterface.save_session">
<code class="descname">save_session</code><span class="sig-paren">(</span><em>app</em>, <em>session</em>, <em>response</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.OctoPrintSessionInterface.save_session" title="Permalink to this definition">¶</a></dt>
<dd><p>This is called for actual sessions returned by <code class="xref py py-meth docutils literal notranslate"><span class="pre">open_session()</span></code>
at the end of the request.  This is still called during a request
context so if you absolutely need access to the request you can do
that.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.flask.PluginAssetResolver">
<em class="property">class </em><code class="descclassname">octoprint.server.util.flask.</code><code class="descname">PluginAssetResolver</code><a class="headerlink" href="#octoprint.server.util.flask.PluginAssetResolver" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="octoprint.server.util.flask.PluginAssetResolver.resolve_output_to_path">
<code class="descname">resolve_output_to_path</code><span class="sig-paren">(</span><em>ctx</em>, <em>target</em>, <em>bundle</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.PluginAssetResolver.resolve_output_to_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Given <code class="docutils literal notranslate"><span class="pre">target</span></code>, this has to return the absolute
filesystem path to which the output file of <code class="docutils literal notranslate"><span class="pre">bundle</span></code>
should be written.</p>
<p><code class="docutils literal notranslate"><span class="pre">target</span></code> may be a relative or absolute path, and is
usually taking from the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Bundle.output</span></code> property.</p>
<p>If a version-placeholder is used (<code class="docutils literal notranslate"><span class="pre">%(version)s</span></code>, it is
still unresolved at this point.</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.flask.PluginAssetResolver.split_prefix">
<code class="descname">split_prefix</code><span class="sig-paren">(</span><em>ctx</em>, <em>item</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.PluginAssetResolver.split_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>See if <code class="docutils literal notranslate"><span class="pre">item</span></code> has blueprint prefix, return (directory, rel_path).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.flask.SettingsCheckUpdater">
<em class="property">class </em><code class="descclassname">octoprint.server.util.flask.</code><code class="descname">SettingsCheckUpdater</code><a class="headerlink" href="#octoprint.server.util.flask.SettingsCheckUpdater" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="octoprint.server.util.flask.SettingsCheckUpdater.build_done">
<code class="descname">build_done</code><span class="sig-paren">(</span><em>bundle</em>, <em>ctx</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.SettingsCheckUpdater.build_done" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be called once a bundle has been successfully built.</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.flask.SettingsCheckUpdater.needs_rebuild">
<code class="descname">needs_rebuild</code><span class="sig-paren">(</span><em>bundle</em>, <em>ctx</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.SettingsCheckUpdater.needs_rebuild" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the given bundle needs to be rebuilt,
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.flask.firstrun_only_access">
<code class="descclassname">octoprint.server.util.flask.</code><code class="descname">firstrun_only_access</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.firstrun_only_access" title="Permalink to this definition">¶</a></dt>
<dd><p>If you decorate a view with this, it will ensure that first setup has _not_ been
done for OctoPrint’s Access Control. Otherwise it
will cause a HTTP 403 status code to be returned by the decorated resource.</p>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.flask.get_flask_user_from_request">
<code class="descclassname">octoprint.server.util.flask.</code><code class="descname">get_flask_user_from_request</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.get_flask_user_from_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the current flask user from the request context. Uses API key if available, otherwise the current
user session if available.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> – flask request from which to retrieve the current user</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the user (might be an anonymous user)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.flask.no_firstrun_access">
<code class="descclassname">octoprint.server.util.flask.</code><code class="descname">no_firstrun_access</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.no_firstrun_access" title="Permalink to this definition">¶</a></dt>
<dd><p>If you decorate a view with this, it will ensure that first setup has been
done for OctoPrint’s Access Control.</p>
<p>If OctoPrint’s Access Control has not been setup yet (indicated by the “firstRun”
flag from the settings being set to True and the userManager not indicating
that it’s user database has been customized from default), the decorator
will cause a HTTP 403 status code to be returned by the decorated resource.</p>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.flask.permission_validator">
<code class="descclassname">octoprint.server.util.flask.</code><code class="descname">permission_validator</code><span class="sig-paren">(</span><em>request</em>, <em>permission</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.permission_validator" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates that the given request is made by an authorized user, identified either by API key or existing Flask
session.</p>
<p>Must be executed in an existing Flask request context!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>request</strong> – The Flask request object</li>
<li><strong>request</strong> – The required permission</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.flask.redirect_to_tornado">
<code class="descclassname">octoprint.server.util.flask.</code><code class="descname">redirect_to_tornado</code><span class="sig-paren">(</span><em>request</em>, <em>target</em>, <em>code=302</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.redirect_to_tornado" title="Permalink to this definition">¶</a></dt>
<dd><p>Redirects from flask to tornado, flask request context must exist.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>request</strong> – </li>
<li><strong>target</strong> – </li>
<li><strong>code</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.flask.restricted_access">
<code class="descclassname">octoprint.server.util.flask.</code><code class="descname">restricted_access</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.flask.restricted_access" title="Permalink to this definition">¶</a></dt>
<dd><p>This combines <a class="reference internal" href="#octoprint.server.util.flask.no_firstrun_access" title="octoprint.server.util.flask.no_firstrun_access"><code class="xref py py-func docutils literal notranslate"><span class="pre">no_firstrun_access()</span></code></a> and <code class="docutils literal notranslate"><span class="pre">login_required</span></code>.</p>
</dd></dl>

</div>
<div class="section" id="module-octoprint.server.util.sockjs">
<span id="octoprint-server-util-sockjs"></span><span id="sec-modules-server-util-sockjs"></span><h1>octoprint.server.util.sockjs<a class="headerlink" href="#module-octoprint.server.util.sockjs" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="octoprint.server.util.sockjs.ThreadSafeSession">
<em class="property">class </em><code class="descclassname">octoprint.server.util.sockjs.</code><code class="descname">ThreadSafeSession</code><span class="sig-paren">(</span><em>conn</em>, <em>server</em>, <em>session_id</em>, <em>expiry=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.sockjs.ThreadSafeSession" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="octoprint.server.util.sockjs.ThreadSafeSession.remove_handler">
<code class="descname">remove_handler</code><span class="sig-paren">(</span><em>handler</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.sockjs.ThreadSafeSession.remove_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Detach active handler from the session</p>
<dl class="docutils">
<dt><cite>handler</cite></dt>
<dd>Handler to remove</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.sockjs.ThreadSafeSession.set_handler">
<code class="descname">set_handler</code><span class="sig-paren">(</span><em>handler</em>, <em>start_heartbeat=True</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.sockjs.ThreadSafeSession.set_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Set active handler for the session</p>
<dl class="docutils">
<dt><cite>handler</cite></dt>
<dd>Associate active Tornado handler with the session</dd>
<dt><cite>start_heartbeat</cite></dt>
<dd>Should session start heartbeat immediately</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-octoprint.server.util.tornado">
<span id="octoprint-server-util-tornado"></span><span id="sec-modules-server-util-tornado"></span><h1>octoprint.server.util.tornado<a class="headerlink" href="#module-octoprint.server.util.tornado" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="octoprint.server.util.tornado.CorsSupportMixin">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">CorsSupportMixin</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CorsSupportMixin" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/web.html#request-handlers">tornado.web.RequestHandler</a> mixin that
makes sure to set CORS headers similarly to the Flask backed API endpoints.</p>
<dl class="method">
<dt id="octoprint.server.util.tornado.CorsSupportMixin.set_default_headers">
<code class="descname">set_default_headers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CorsSupportMixin.set_default_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Override this to set HTTP headers at the beginning of the request.</p>
<p>For example, this is the place to set a custom <code class="docutils literal notranslate"><span class="pre">Server</span></code> header.
Note that setting such headers in the normal flow of request
processing may not do what you want, since headers may be reset
during error handling.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.CustomHTTP1Connection">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">CustomHTTP1Connection</code><span class="sig-paren">(</span><em>stream</em>, <em>is_client</em>, <em>params=None</em>, <em>context=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CustomHTTP1Connection" title="Permalink to this definition">¶</a></dt>
<dd><p>A custom implementation of <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1Connection</span></code> which upon checking the <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> of
the request against the configured maximum utilizes <code class="docutils literal notranslate"><span class="pre">max_body_sizes</span></code> and <code class="docutils literal notranslate"><span class="pre">default_max_body_size</span></code> as a fallback.</p>
</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.CustomHTTP1ConnectionParameters">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">CustomHTTP1ConnectionParameters</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CustomHTTP1ConnectionParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>An implementation of <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1ConnectionParameters</span></code> that adds two new parameters
<code class="docutils literal notranslate"><span class="pre">max_body_sizes</span></code> and <code class="docutils literal notranslate"><span class="pre">default_max_body_size</span></code>.</p>
<p>For a description of these please see the documentation of <code class="docutils literal notranslate"><span class="pre">CustomHTTPServer</span></code> above.</p>
</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.CustomHTTP1ServerConnection">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">CustomHTTP1ServerConnection</code><span class="sig-paren">(</span><em>stream</em>, <em>params=None</em>, <em>context=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CustomHTTP1ServerConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>A custom implementation of <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1ServerConnection</span></code> which utilizes a <code class="docutils literal notranslate"><span class="pre">CustomHTTP1Connection</span></code>
instead of a <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1Connection</span></code> in <code class="docutils literal notranslate"><span class="pre">_server_request_loop</span></code>. The implementation logic is
otherwise the same as <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1ServerConnection</span></code>.</p>
</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.CustomHTTPServer">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">CustomHTTPServer</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CustomHTTPServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom implementation of <code class="docutils literal notranslate"><span class="pre">tornado.httpserver.HTTPServer</span></code> that allows defining max body sizes depending on path and
method.</p>
<p>The implementation is mostly taken from <code class="docutils literal notranslate"><span class="pre">tornado.httpserver.HTTPServer</span></code>, the only difference is the creation
of a <code class="docutils literal notranslate"><span class="pre">CustomHTTP1ConnectionParameters</span></code> instance instead of <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1ConnectionParameters</span></code>
which is supplied with the two new constructor arguments <code class="docutils literal notranslate"><span class="pre">max_body_sizes</span></code> and <code class="docutils literal notranslate"><span class="pre">max_default_body_size</span></code> and the
creation of a <code class="docutils literal notranslate"><span class="pre">CustomHTTP1ServerConnection</span></code> instead of a <code class="docutils literal notranslate"><span class="pre">tornado.http1connection.HTTP1ServerConnection</span></code> upon
connection by a client.</p>
<p><code class="docutils literal notranslate"><span class="pre">max_body_sizes</span></code> is expected to be an iterable containing tuples of the form (method, path regex, maximum body size),
with method and path regex having to match in order for maximum body size to take affect.</p>
<p><code class="docutils literal notranslate"><span class="pre">default_max_body_size</span></code> is the default maximum body size to apply if no specific one from <code class="docutils literal notranslate"><span class="pre">max_body_sizes</span></code> matches.</p>
<dl class="method">
<dt id="octoprint.server.util.tornado.CustomHTTPServer.handle_stream">
<code class="descname">handle_stream</code><span class="sig-paren">(</span><em>stream</em>, <em>address</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CustomHTTPServer.handle_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to handle a new <cite>.IOStream</cite> from an incoming connection.</p>
<p>This method may be a coroutine; if so any exceptions it raises
asynchronously will be logged. Accepting of incoming connections
will not be blocked by this coroutine.</p>
<p>If this <cite>TCPServer</cite> is configured for SSL, <code class="docutils literal notranslate"><span class="pre">handle_stream</span></code>
may be called before the SSL handshake has completed. Use
<cite>.SSLIOStream.wait_for_handshake</cite> if you need to verify the client’s
certificate or use NPN/ALPN.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>Added the option for this method to be a coroutine.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.CustomHTTPServer.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.CustomHTTPServer.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <cite>Configurable</cite> subclass instance.</p>
<p>Configurable classes should use <cite>initialize</cite> instead of <code class="docutils literal notranslate"><span class="pre">__init__</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>Now accepts positional arguments in addition to keyword arguments.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.DeprecatedEndpointHandler">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">DeprecatedEndpointHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.DeprecatedEndpointHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/web.html#request-handlers">tornado.web.RequestHandler</a> that redirects
to another <code class="docutils literal notranslate"><span class="pre">url</span></code> and logs a deprecation warning.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>url</strong> (<em>str</em>) – URL to which to redirect</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="octoprint.server.util.tornado.DeprecatedEndpointHandler.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>url</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.DeprecatedEndpointHandler.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook for subclass initialization. Called for each request.</p>
<p>A dictionary passed as the third argument of a url spec will be
supplied as keyword arguments to initialize().</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProfileHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
        <span class="o">...</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/user/(.*)&#39;</span><span class="p">,</span> <span class="n">ProfileHandler</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)),</span>
    <span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.GlobalHeaderTransform">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">GlobalHeaderTransform</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.GlobalHeaderTransform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.LargeResponseHandler">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">LargeResponseHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Customized <a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/web.html#tornado.web.StaticFileHandler">tornado.web.StaticFileHandler</a>
that allows delivery of the requested resource as attachment and access and request path validation through
optional callbacks. Note that access validation takes place before path validation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<em>str</em>) – The system path from which to serve files (this will be forwarded to the <code class="docutils literal notranslate"><span class="pre">initialize</span></code> method of
:class:<code class="docutils literal notranslate"><span class="pre">~tornado.web.StaticFileHandler</span></code>)</li>
<li><strong>default_filename</strong> (<em>str</em>) – The default filename to serve if none is explicitly specified and the request references
a subdirectory of the served path (this will be forwarded to the <code class="docutils literal notranslate"><span class="pre">initialize</span></code> method of
:class:<code class="docutils literal notranslate"><span class="pre">~tornado.web.StaticFileHandler</span></code> as the <code class="docutils literal notranslate"><span class="pre">default_filename</span></code> keyword parameter). Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</li>
<li><strong>as_attachment</strong> (<em>bool</em>) – Whether to serve requested files with <code class="docutils literal notranslate"><span class="pre">Content-Disposition:</span> <span class="pre">attachment</span></code> header (<code class="docutils literal notranslate"><span class="pre">True</span></code>)
or not. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</li>
<li><strong>allow_client_caching</strong> (<em>bool</em>) – Whether to allow the client to cache (by not setting any <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> or
<code class="docutils literal notranslate"><span class="pre">Expires</span></code> headers on the response) or not.</li>
<li><strong>access_validation</strong> (<em>function</em>) – Callback to call in the <code class="docutils literal notranslate"><span class="pre">get</span></code> method to validate access to the resource. Will
be called with <code class="docutils literal notranslate"><span class="pre">self.request</span></code> as parameter which contains the full tornado request object. Should raise
a <code class="docutils literal notranslate"><span class="pre">tornado.web.HTTPError</span></code> if access is not allowed in which case the request will not be further processed.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> and hence no access validation being performed.</li>
<li><strong>path_validation</strong> (<em>function</em>) – Callback to call in the <code class="docutils literal notranslate"><span class="pre">get</span></code> method to validate the requested path. Will be called
with the requested path as parameter. Should raise a <code class="docutils literal notranslate"><span class="pre">tornado.web.HTTPError</span></code> (e.g. an 404) if the requested
path does not pass validation in which case the request will not be further processed.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> and hence no path validation being performed.</li>
<li><strong>etag_generator</strong> (<em>function</em>) – Callback to call for generating the value of the ETag response header. Will be
called with the response handler as parameter. May return <code class="docutils literal notranslate"><span class="pre">None</span></code> to prevent the ETag response header
from being set. If not provided the last modified time of the file in question will be used as returned
by <code class="docutils literal notranslate"><span class="pre">get_content_version</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="octoprint.server.util.tornado.LargeResponseHandler.compute_etag">
<code class="descname">compute_etag</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler.compute_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the etag header to be used for this request.</p>
<p>By default uses a hash of the content written so far.</p>
<p>May be overridden to provide custom etag implementations,
or may return None to disable tornado’s default etag support.</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.LargeResponseHandler.get_content_type">
<code class="descname">get_content_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler.get_content_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header to be used for this request.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="octoprint.server.util.tornado.LargeResponseHandler.get_content_version">
<em class="property">classmethod </em><code class="descname">get_content_version</code><span class="sig-paren">(</span><em>abspath</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler.get_content_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a version string for the resource at the given path.</p>
<p>This class method may be overridden by subclasses.  The
default implementation is a hash of the file’s contents.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.LargeResponseHandler.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>path</em>, <em>default_filename=None</em>, <em>as_attachment=False</em>, <em>allow_client_caching=True</em>, <em>access_validation=None</em>, <em>path_validation=None</em>, <em>etag_generator=None</em>, <em>name_generator=None</em>, <em>mime_type_guesser=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook for subclass initialization. Called for each request.</p>
<p>A dictionary passed as the third argument of a url spec will be
supplied as keyword arguments to initialize().</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProfileHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
        <span class="o">...</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/user/(.*)&#39;</span><span class="p">,</span> <span class="n">ProfileHandler</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)),</span>
    <span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.LargeResponseHandler.set_extra_headers">
<code class="descname">set_extra_headers</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.LargeResponseHandler.set_extra_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>For subclass to add extra headers to the response</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.RequestlessExceptionLoggingMixin">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">RequestlessExceptionLoggingMixin</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.RequestlessExceptionLoggingMixin" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="octoprint.server.util.tornado.RequestlessExceptionLoggingMixin.log_exception">
<code class="descname">log_exception</code><span class="sig-paren">(</span><em>typ</em>, <em>value</em>, <em>tb</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.RequestlessExceptionLoggingMixin.log_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to customize logging of uncaught exceptions.</p>
<p>By default logs instances of <cite>HTTPError</cite> as warnings without
stack traces (on the <code class="docutils literal notranslate"><span class="pre">tornado.general</span></code> logger), and all
other exceptions as errors with stack traces (on the
<code class="docutils literal notranslate"><span class="pre">tornado.application</span></code> logger).</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.StaticDataHandler">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">StaticDataHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.StaticDataHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/web.html#request-handlers">tornado.web.RequestHandler</a> that returns
static <code class="docutils literal notranslate"><span class="pre">data</span></code> of a configured <code class="docutils literal notranslate"><span class="pre">content_type</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>str</em>) – The data with which to respond</li>
<li><strong>content_type</strong> (<em>str</em>) – The content type with which to respond. Defaults to <code class="docutils literal notranslate"><span class="pre">text/plain</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="octoprint.server.util.tornado.StaticDataHandler.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>data=''</em>, <em>content_type='text/plain'</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.StaticDataHandler.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook for subclass initialization. Called for each request.</p>
<p>A dictionary passed as the third argument of a url spec will be
supplied as keyword arguments to initialize().</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProfileHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
        <span class="o">...</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/user/(.*)&#39;</span><span class="p">,</span> <span class="n">ProfileHandler</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)),</span>
    <span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">UploadStorageFallbackHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>A <code class="docutils literal notranslate"><span class="pre">RequestHandler</span></code> similar to <code class="docutils literal notranslate"><span class="pre">tornado.web.FallbackHandler</span></code> which fetches any files contained in the request bodies
of content type <code class="docutils literal notranslate"><span class="pre">multipart</span></code>, stores them in temporary files and supplies the <code class="docutils literal notranslate"><span class="pre">fallback</span></code> with the file’s <code class="docutils literal notranslate"><span class="pre">name</span></code>,
<code class="docutils literal notranslate"><span class="pre">content_type</span></code>, <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">size</span></code> instead via a rewritten body.</p>
<p>Basically similar to what the nginx upload module does.</p>
<p>Basic request body example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.gcode&quot;
Content-Type: application/octet-stream

...
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;apikey&quot;

my_funny_apikey
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;select&quot;

true
------WebKitFormBoundarypYiSUx63abAmhT5C--
</pre></div>
</div>
<p>That would get turned into:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;apikey&quot;

my_funny_apikey
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;select&quot;

true
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;file.path&quot;
Content-Type: text/plain; charset=utf-8

/tmp/tmpzupkro
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;file.name&quot;
Content-Type: text/plain; charset=utf-8

test.gcode
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;file.content_type&quot;
Content-Type: text/plain; charset=utf-8

application/octet-stream
------WebKitFormBoundarypYiSUx63abAmhT5C
Content-Disposition: form-data; name=&quot;file.size&quot;
Content-Type: text/plain; charset=utf-8

349182
------WebKitFormBoundarypYiSUx63abAmhT5C--
</pre></div>
</div>
<p>The underlying application can then access the contained files via their respective paths and just move them
where necessary.</p>
<dl class="attribute">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.BODY_METHODS">
<code class="descname">BODY_METHODS</code><em class="property"> = ('POST', 'PATCH', 'PUT')</em><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.BODY_METHODS" title="Permalink to this definition">¶</a></dt>
<dd><p>The request methods that may contain a request body.</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.data_received">
<code class="descname">data_received</code><span class="sig-paren">(</span><em>chunk</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.data_received" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by Tornado on receiving a chunk of the request body. If request is a multipart request, takes care of
processing the multipart data structure via <code class="xref py py-func docutils literal notranslate"><span class="pre">_process_multipart_data()</span></code>. If not, just adds the chunk to
internal in-memory buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>chunk</strong> – chunk of data received from Tornado</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.head">
<code class="descname">head</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.head" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>fallback</em>, <em>file_prefix='tmp'</em>, <em>file_suffix=''</em>, <em>path=None</em>, <em>suffixes=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook for subclass initialization. Called for each request.</p>
<p>A dictionary passed as the third argument of a url spec will be
supplied as keyword arguments to initialize().</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProfileHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
        <span class="o">...</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/user/(.*)&#39;</span><span class="p">,</span> <span class="n">ProfileHandler</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)),</span>
    <span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.is_multipart">
<code class="descname">is_multipart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.is_multipart" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether this request is a <code class="docutils literal notranslate"><span class="pre">multipart</span></code> request</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.options">
<code class="descname">options</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.patch">
<code class="descname">patch</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.post">
<code class="descname">post</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.prepare">
<code class="descname">prepare</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the processing of the request. If it’s a request that may contain a request body (as defined in
<a class="reference internal" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.BODY_METHODS" title="octoprint.server.util.tornado.UploadStorageFallbackHandler.BODY_METHODS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">UploadStorageFallbackHandler.BODY_METHODS</span></code></a>) prepares the multipart parsing if content type fits. If it’s a
body-less request, just calls the <code class="docutils literal notranslate"><span class="pre">fallback</span></code> with an empty body and finishes the request.</p>
</dd></dl>

<dl class="method">
<dt id="octoprint.server.util.tornado.UploadStorageFallbackHandler.put">
<code class="descname">put</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UploadStorageFallbackHandler.put" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes care of defining the new request body if necessary and forwarding
the current request and changed body to the <code class="docutils literal notranslate"><span class="pre">fallback</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.UrlProxyHandler">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">UrlProxyHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UrlProxyHandler" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/web.html#request-handlers">tornado.web.RequestHandler</a> that proxies
requests to a preconfigured url and returns the response. Allows delivery of the requested content as attachment
and access validation through an optional callback.</p>
<p>This will use <a class="reference external" href="http://tornado.readthedocs.org/en/branch4.0/httpclient.html#tornado.httpclient.AsyncHTTPClient">tornado.httpclient.AsyncHTTPClient</a>
for making the request to the configured endpoint and return the body of the client response with the status code
from the client response and the following headers:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Date</span></code>, <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code>, <code class="docutils literal notranslate"><span class="pre">Expires</span></code>, <code class="docutils literal notranslate"><span class="pre">ETag</span></code>, <code class="docutils literal notranslate"><span class="pre">Server</span></code>, <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> and <code class="docutils literal notranslate"><span class="pre">Location</span></code> will be copied over.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">as_attachment</span></code> is set to True, <code class="docutils literal notranslate"><span class="pre">Content-Disposition</span></code> will be set to <code class="docutils literal notranslate"><span class="pre">attachment</span></code>. If <code class="docutils literal notranslate"><span class="pre">basename</span></code> is
set including the attachment’s <code class="docutils literal notranslate"><span class="pre">filename</span></code> attribute will be set to the base name followed by the extension
guessed based on the MIME type from the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header of the response. If no extension can be guessed
no <code class="docutils literal notranslate"><span class="pre">filename</span></code> attribute will be set.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>url</strong> (<em>str</em>) – URL to forward any requests to. A 404 response will be returned if this is not set. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</li>
<li><strong>as_attachment</strong> (<em>bool</em>) – Whether to serve files with <code class="docutils literal notranslate"><span class="pre">Content-Disposition:</span> <span class="pre">attachment</span></code> header (<code class="docutils literal notranslate"><span class="pre">True</span></code>)
or not. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</li>
<li><strong>basename</strong> (<em>str</em>) – base name of file names to return as part of the attachment header, see above. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</li>
<li><strong>access_validation</strong> (<em>function</em>) – Callback to call in the <code class="docutils literal notranslate"><span class="pre">get</span></code> method to validate access to the resource. Will
be called with <code class="docutils literal notranslate"><span class="pre">self.request</span></code> as parameter which contains the full tornado request object. Should raise
a <code class="docutils literal notranslate"><span class="pre">tornado.web.HTTPError</span></code> if access is not allowed in which case the request will not be further processed.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> and hence no access validation being performed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="octoprint.server.util.tornado.UrlProxyHandler.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>url=None</em>, <em>as_attachment=False</em>, <em>basename=None</em>, <em>access_validation=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.UrlProxyHandler.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook for subclass initialization. Called for each request.</p>
<p>A dictionary passed as the third argument of a url spec will be
supplied as keyword arguments to initialize().</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProfileHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
        <span class="o">...</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/user/(.*)&#39;</span><span class="p">,</span> <span class="n">ProfileHandler</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)),</span>
    <span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="octoprint.server.util.tornado.WsgiInputContainer">
<em class="property">class </em><code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">WsgiInputContainer</code><span class="sig-paren">(</span><em>wsgi_application</em>, <em>headers=None</em>, <em>forced_headers=None</em>, <em>removed_headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.WsgiInputContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>A WSGI container for use with Tornado that allows supplying the request body to be used for <code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code> in the
generated WSGI environment upon call.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">RequestHandler</span></code> can thus provide the WSGI application with a stream for the request body, or a modified body.</p>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">octoprint</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">WsgiInputContainer</span><span class="p">(</span><span class="n">octoprint_app</span><span class="p">)</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*&quot;</span><span class="p">,</span> <span class="n">UploadStorageFallbackHandler</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fallback</span><span class="o">=</span><span class="n">wsgi_app</span><span class="p">),</span>
<span class="p">])</span>
</pre></div>
</div>
<p>The implementation logic is basically the same as <code class="docutils literal notranslate"><span class="pre">tornado.wsgi.WSGIContainer</span></code> but the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> and <code class="docutils literal notranslate"><span class="pre">environ</span></code>
methods have been adjusted to allow for an optionally supplied <code class="docutils literal notranslate"><span class="pre">body</span></code> argument which is then used for <code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code>.</p>
<dl class="staticmethod">
<dt id="octoprint.server.util.tornado.WsgiInputContainer.environ">
<em class="property">static </em><code class="descname">environ</code><span class="sig-paren">(</span><em>request</em>, <em>body=None</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.WsgiInputContainer.environ" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a <code class="docutils literal notranslate"><span class="pre">tornado.httputil.HTTPServerRequest</span></code> to a WSGI environment.</p>
<p>An optional <code class="docutils literal notranslate"><span class="pre">body</span></code> to be used for populating <code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code> can be supplied (either a string or a stream). If not
supplied, <code class="docutils literal notranslate"><span class="pre">request.body</span></code> will be wrapped into a <code class="docutils literal notranslate"><span class="pre">io.BytesIO</span></code> stream and used instead.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>request</strong> – the <code class="docutils literal notranslate"><span class="pre">tornado.httpserver.HTTPServerRequest</span></code> to derive the WSGI environment from</li>
<li><strong>body</strong> – an optional body  to use as <code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code> instead of <code class="docutils literal notranslate"><span class="pre">request.body</span></code>, can be a string or a stream</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.tornado.access_validation_factory">
<code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">access_validation_factory</code><span class="sig-paren">(</span><em>app</em>, <em>validator</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.access_validation_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an access validation wrapper using the supplied validator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>validator</strong> – the access validator to use inside the validation wrapper</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">an access validator taking a request as parameter and performing the request validation</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.tornado.fix_json_encode">
<code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">fix_json_encode</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.fix_json_encode" title="Permalink to this definition">¶</a></dt>
<dd><p>This makes tornado.escape.json_encode use octoprint.util.JsonEncoding.encode as fallback in order to allow
serialization of globally registered types like frozendict and others.</p>
</dd></dl>

<dl class="function">
<dt id="octoprint.server.util.tornado.path_validation_factory">
<code class="descclassname">octoprint.server.util.tornado.</code><code class="descname">path_validation_factory</code><span class="sig-paren">(</span><em>path_filter</em>, <em>status_code=404</em><span class="sig-paren">)</span><a class="headerlink" href="#octoprint.server.util.tornado.path_validation_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a request path validation wrapper returning the defined status code if the supplied path_filter returns False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path_filter</strong> – the path filter to use on the requested path, should return False for requests that should
be responded with the provided error code.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a request path validator taking a request path as parameter and performing the request validation</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="settings.html" class="btn btn-neutral float-right" title="octoprint.settings" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="printer.html" class="btn btn-neutral float-left" title="octoprint.printer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2020, Gina Häußge

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: 1.4.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="https://docs.octoprint.org/en/1.3.12/modules/server.html">1.3.12</a></dd>
      <dd><a href="https://docs.octoprint.org/en/1.4.0/modules/server.html">1.4.0</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="https://docs.octoprint.org/en/master/modules/server.html">master</a></dd>
      <dd><a href="https://docs.octoprint.org/en/maintenance/modules/server.html">maintenance</a></dd>
      <dd><a href="https://docs.octoprint.org/en/devel/modules/server.html">devel</a></dd>
    </dl>
  </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>