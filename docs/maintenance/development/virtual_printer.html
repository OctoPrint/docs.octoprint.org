

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Setting up the virtual printer for debugging &mdash; OctoPrint maintenance documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="https://unpkg.com/mermaid@8.4.8/dist/mermaid.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developing Plugins" href="../plugins/index.html" />
    <link rel="prev" title="Setting up a Development environment" href="environment.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> OctoPrint
          

          
          </a>

          
            
            
              <div class="version">
                maintenance
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bundledplugins/index.html">Bundled Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../events/index.html">Events</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="environment.html">Setting up a Development environment</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Setting up the virtual printer for debugging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enabling-the-virtual-printer">Enabling the virtual printer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#virtual-printer-configuration-options">Virtual printer configuration options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#log-file">Log file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debug-commands">Debug commands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Developing Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">Internal Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jsclientlib/index.html">JavaScript Client Library</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OctoPrint</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">


  <p style="padding: 10px;margin: 0 0 10px 0;border-radius: 2px;letter-spacing: 1px;font-size: 13px;color: white;text-align: center;background: #3a87ad;background-image: none;background-size: auto;background-size: 28px 28px;background-image: linear-gradient( -45deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.2) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.2) 50%, rgba(255, 255, 255, 0.2) 75%, transparent 75%, transparent );">
    <strong>Note:</strong>
    These are not the docs of the latest released version. Those can be found <a href="https://docs.octoprint.org/1.4.0" style="color: white;text-decoration: underline">here</a>.
  </p>


  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Development</a> &raquo;</li>
        
      <li>Setting up the virtual printer for debugging</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/development/virtual_printer.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="setting-up-the-virtual-printer-for-debugging">
<span id="sec-development-virtual-printer"></span><h1>Setting up the virtual printer for debugging<a class="headerlink" href="#setting-up-the-virtual-printer-for-debugging" title="Permalink to this headline">¶</a></h1>
<p>OctoPrint includes, by default, a virtual printer plugin. This plugin allows you to debug OctoPrint’s serial
communication without connecting to an actual printer. Furthermore, it is possible to create certain edge conditions
that may be hard to reproduce with a real printer.</p>
<div class="section" id="enabling-the-virtual-printer">
<span id="sec-development-virtual-printer-enable"></span><h2>Enabling the virtual printer<a class="headerlink" href="#enabling-the-virtual-printer" title="Permalink to this headline">¶</a></h2>
<p>The virtual printer can be enabled through its Settings pane.</p>
</div>
<div class="section" id="virtual-printer-configuration-options">
<span id="sec-development-virtual-printer-config"></span><h2>Virtual printer configuration options<a class="headerlink" href="#virtual-printer-configuration-options" title="Permalink to this headline">¶</a></h2>
<p>The config.yaml file has many configuration options for the virtual printer that allow you to fine-tune its behavior.</p>
<p>Please see the relevant <a class="reference internal" href="../configuration/config_yaml.html#sec-configuration-config-yaml-devel"><span class="std std-ref">config.yaml section</span></a> for the full details.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">plugins</span><span class="p">:</span>

  <span class="c1"># Settings for the virtual printer</span>
  <span class="nt">virtual_printer</span><span class="p">:</span>

    <span class="c1"># Whether to enable the virtual printer and include it in the list of available serial connections.</span>
    <span class="c1"># Defaults to false.</span>
    <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>

    <span class="c1"># Whether to send an additional &quot;ok&quot; after a resend request (like Repetier)</span>
    <span class="nt">okAfterResend</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># Whether to force checksums and line number in the communication (like Repetier), if set to true</span>
    <span class="c1"># printer will only accept commands that come with linenumber and checksum and throw an error for</span>
    <span class="c1"># lines that don&#39;t. Defaults to false</span>
    <span class="nt">forceChecksum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># Whether to send &quot;ok&quot; responses with the line number that gets acknowledged by the &quot;ok&quot;. Defaults</span>
    <span class="c1"># to false.</span>
    <span class="nt">okWithLinenumber</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># Number of extruders to simulate on the virtual printer. Map from tool id (0, 1, ...) to temperature</span>
    <span class="c1"># in °C</span>
    <span class="nt">numExtruders</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>

    <span class="c1"># Allows pinning certain hotends to a fixed temperature</span>
    <span class="nt">pinnedExtruders</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>

    <span class="c1"># Whether to include the current tool temperature in the M105 output as separate T segment or not.</span>
    <span class="c1">#</span>
    <span class="c1"># True:  &gt; M105</span>
    <span class="c1">#        &lt; ok T:23.5/0.0 T0:34.3/0.0 T1:23.5/0.0 B:43.2/0.0</span>
    <span class="c1"># False: &gt; M105</span>
    <span class="c1">#        &lt; ok T0:34.3/0.0 T1:23.5/0.0 B:43.2/0.0</span>
    <span class="nt">includeCurrentToolInTemps</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>

    <span class="c1"># Whether to include the selected filename in the M23 File opened response.</span>
    <span class="c1">#</span>
    <span class="c1"># True:  &gt; M23 filename.gcode</span>
    <span class="c1">#        &lt; File opened: filename.gcode  Size: 27</span>
    <span class="c1"># False: &gt; M23 filename.gcode</span>
    <span class="c1">#        &gt; File opened</span>
    <span class="nt">includeFilenameInOpened</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>

    <span class="c1"># Whether the simulated printer should also simulate a heated bed or not</span>
    <span class="nt">hasBed</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>

    <span class="c1"># Whether the simulated printer should also simulate a heated chamber or not</span>
    <span class="nt">hasChamber</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># If enabled, reports the set target temperatures as separate messages from the firmware</span>
    <span class="c1">#</span>
    <span class="c1"># True:  &gt; M109 S220.0</span>
    <span class="c1">#        &lt; TargetExtr0:220.0</span>
    <span class="c1">#        &lt; ok</span>
    <span class="c1">#        &gt; M105</span>
    <span class="c1">#        &lt; ok T0:34.3 T1:23.5 B:43.2</span>
    <span class="c1"># False: &gt; M109 S220.0</span>
    <span class="c1">#        &lt; ok</span>
    <span class="c1">#        &gt; M105</span>
    <span class="c1">#        &lt; ok T0:34.3/220.0 T1:23.5/0.0 B:43.2/0.0</span>
    <span class="nt">repetierStyleTargetTemperature</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># If enabled, uses repetier style resends, sending multiple resends for the same line</span>
    <span class="c1"># to make sure nothing gets lost on the line</span>
    <span class="nt">repetierStyleResends</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># If enabled, ok will be sent before a commands output, otherwise after or inline (M105)</span>
    <span class="c1">#</span>
    <span class="c1"># True:  &gt; M20</span>
    <span class="c1">#        &lt; ok</span>
    <span class="c1">#        &lt; Begin file list</span>
    <span class="c1">#        &lt; End file list</span>
    <span class="c1"># False: &gt; M20</span>
    <span class="c1">#        &lt; Begin file list</span>
    <span class="c1">#        &lt; End file list</span>
    <span class="c1">#        &lt; ok</span>
    <span class="nt">okBeforeCommandOutput</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># If enabled, reports the first extruder in M105 responses as T instead of T0</span>
    <span class="c1">#</span>
    <span class="c1"># True:  &gt; M105</span>
    <span class="c1">#        &lt; ok T:34.3/0.0 T1:23.5/0.0 B:43.2/0.0</span>
    <span class="c1"># False: &gt; M105</span>
    <span class="c1">#        &lt; ok T0:34.3/0.0 T1:23.5/0.0 B:43.2/0.0</span>
    <span class="nt">smoothieTemperatureReporting</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># Whether M20 responses will include filesize or not</span>
    <span class="c1">#</span>
    <span class="c1"># True:  &lt;filename&gt; &lt;filesize in bytes&gt;</span>
    <span class="c1"># False: &lt;filename&gt;</span>
    <span class="nt">extendedSdFileList</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># Forced pause for retrieving from the outgoing buffer</span>
    <span class="nt">throttle</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.01</span>

    <span class="c1"># Whether to send &quot;wait&quot; responses every &quot;waitInterval&quot; seconds when serial rx buffer is empty</span>
    <span class="nt">sendWait</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># Interval in which to send &quot;wait&quot; lines when rx buffer is empty</span>
    <span class="nt">waitInterval</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>

    <span class="c1"># Size of the simulated RX buffer in bytes, when it&#39;s full a send from OctoPrint&#39;s</span>
    <span class="c1"># side will block</span>
    <span class="nt">rxBuffer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">64</span>

    <span class="c1"># Size of simulated command buffer, number of commands. If full, buffered commands will block</span>
    <span class="c1"># until a slot frees up</span>
    <span class="nt">commandBuffer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4</span>

    <span class="c1"># Whether to support the M112 command with simulated kill</span>
    <span class="nt">supportM112</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>

    <span class="c1"># Whether to send messages received via M117 back as &quot;echo:&quot; lines</span>
    <span class="nt">echoOnM117</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>

    <span class="c1"># Whether to simulate broken M29 behaviour (missing ok after response)</span>
    <span class="nt">brokenM29</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>

    <span class="c1"># Whether F is supported as individual command</span>
    <span class="nt">supportF</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># Firmware name to report (useful for testing firmware detection)</span>
    <span class="nt">firmwareName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Virtual Marlin 1.0</span>

    <span class="c1"># Simulate a shared nozzle</span>
    <span class="nt">sharedNozzle</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># Send &quot;busy&quot; messages if busy processing something</span>
    <span class="nt">sendBusy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># Simulate a reset on connect</span>
    <span class="nt">simulateReset</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>

    <span class="c1"># Lines to send on simulated reset</span>
    <span class="nt">resetLines</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">start</span>
    <span class="p p-Indicator">-</span> <span class="s">&quot;Marlin:</span><span class="nv"> </span><span class="s">Virtual</span><span class="nv"> </span><span class="s">Marlin!&quot;</span>
    <span class="p p-Indicator">-</span> <span class="s">&quot;SD</span><span class="nv"> </span><span class="s">card</span><span class="nv"> </span><span class="s">ok&quot;</span>

    <span class="c1"># Initial set of prepared oks to use instead of regular ok (e.g. to simulate</span>
    <span class="c1"># mis-sent oks). Can also be filled at runtime via the debug command prepare_ok</span>
    <span class="nt">preparedOks</span><span class="p">:</span> <span class="p p-Indicator">[]</span>

    <span class="c1"># Format string for ok response.</span>
    <span class="c1">#</span>
    <span class="c1"># Placeholders:</span>
    <span class="c1"># - lastN: last acknowledged line number</span>
    <span class="c1"># - buffer: empty slots in internal command buffer</span>
    <span class="c1">#</span>
    <span class="c1"># Example format string for &quot;extended&quot; ok format:</span>
    <span class="c1">#   ok N{lastN} P{buffer}</span>
    <span class="nt">okFormatString</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ok</span>

    <span class="c1"># Format string for M115 output.</span>
    <span class="c1">#</span>
    <span class="c1"># Placeholders:</span>
    <span class="c1"># - firmare_name: The firmware name as defined in firmwareName</span>
    <span class="nt">m115FormatString</span><span class="p">:</span> <span class="s">&quot;FIRMWARE_NAME:</span><span class="nv"> </span><span class="s">{firmware_name}</span><span class="nv"> </span><span class="s">PROTOCOL_VERSION:1.0&quot;</span>

    <span class="c1"># Whether to include capability report in M115 output</span>
    <span class="nt">m115ReportCapabilites</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

    <span class="c1"># Capabilities to report if capability report is enabled</span>
    <span class="nt">capabilities</span><span class="p">:</span>
      <span class="nt">AUTOREPORT_TEMP</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>

    <span class="c1"># Simulated ambient temperature in °C</span>
    <span class="nt">ambientTemperature</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">21.3</span>
</pre></div>
</div>
</div>
<div class="section" id="log-file">
<span id="sec-development-virtual-printer-log"></span><h2>Log file<a class="headerlink" href="#log-file" title="Permalink to this headline">¶</a></h2>
<p>Once activated, the virtual printer will log all serial communication in the <code class="docutils literal notranslate"><span class="pre">plugin_virtual_printer_serial.log</span></code> file
that can be found in the OctoPrint settings folder.</p>
</div>
<div class="section" id="debug-commands">
<span id="sec-development-virtual-printer-debug"></span><h2>Debug commands<a class="headerlink" href="#debug-commands" title="Permalink to this headline">¶</a></h2>
<p>You can simulate certain conditions and communications through the terminal tab in OctoPrint’s interface.</p>
<p>All commands start with <code class="docutils literal notranslate"><span class="pre">!!DEBUG:</span></code> and are followed by the command you want to execute. For instance, sending
<code class="docutils literal notranslate"><span class="pre">!!DEBUG:action_disconnect</span></code> will disconnect the printer. Sending <code class="docutils literal notranslate"><span class="pre">!!DEBUG</span></code> without command will show a help
message with all the available commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OctoPrint Virtual Printer debug commands

help
?
| This help.

# Action Triggers

action_pause
| Sends a &quot;// action:pause&quot; action trigger to the host.
action_resume
| Sends a &quot;// action:resume&quot; action trigger to the host.
action_disconnect
| Sends a &quot;// action:disconnect&quot; action trigger to the
| host.
action_custom &lt;action&gt;[ &lt;parameters&gt;]
| Sends a custom &quot;// action:&lt;action&gt; &lt;parameters&gt;&quot;
| action trigger to the host.

# Communication Errors

dont_answer
| Will not acknowledge the next command.
go_awol
| Will completely stop replying
trigger_resend_lineno
| Triggers a resend error with a line number mismatch
trigger_resend_checksum
| Triggers a resend error with a checksum mismatch
trigger_missing_checksum
| Triggers a resend error with a missing checksum
trigger_missing_lineno
| Triggers a &quot;no line number with checksum&quot; error w/o resend request
drop_connection
| Drops the serial connection
prepare_ok &lt;broken ok&gt;
| Will cause &lt;broken ok&gt; to be enqueued for use,
| will be used instead of actual &quot;ok&quot;

# Reply Timing / Sleeping

sleep &lt;int:seconds&gt;
| Sleep &lt;seconds&gt; s
sleep_after &lt;str:command&gt; &lt;int:seconds&gt;
| Sleeps &lt;seconds&gt; s after each execution of &lt;command&gt;
sleep_after_next &lt;str:command&gt; &lt;int:seconds&gt;
| Sleeps &lt;seconds&gt; s after execution of next &lt;command&gt;

# SD printing

start_sd &lt;str:file&gt;
| Select and start printing file &lt;file&gt; from SD
select_sd &lt;str:file&gt;
| Select file &lt;file&gt; from SD, don&#39;t start printing it yet. Use
| start_sd to start the print
cancel_sd
| Cancels an ongoing SD print

# Misc

send &lt;str:message&gt;
| Sends back &lt;message&gt;
reset
| Simulates a reset. Internal state will be lost.
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../plugins/index.html" class="btn btn-neutral float-right" title="Developing Plugins" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="environment.html" class="btn btn-neutral float-left" title="Setting up a Development environment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2020, Gina Häußge

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: maintenance
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="https://docs.octoprint.org/1.3.12">1.3.12</a></dd>
      <dd><a href="https://docs.octoprint.org/1.4.0">1.4.0</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="https://docs.octoprint.org/master">master</a></dd>
      <dd><a href="https://docs.octoprint.org/maintenance">maintenance</a></dd>
      <dd><a href="https://docs.octoprint.org/devel">devel</a></dd>
    </dl>
  </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>