<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GCODE Scripts &mdash; OctoPrint master documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=3dbc9e18" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=1e67d180" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=30d551ce"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/mermaid.min.js?v=c0ebaf0d"></script>
        <script data-domain="docs.octoprint.org" defer="defer" src="https://plausible.octoprint.org/js/plausible.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Action Commands" href="action_commands.html" />
    <link rel="prev" title="Custom Controls" href="custom_controls.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            OctoPrint
          </a>
              <div class="version">
                master
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Features</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="accesscontrol.html">Access Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom_controls.html">Custom Controls</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GCODE Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#predefined-scripts">Predefined Scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#events">Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#snippets">Snippets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bundled-scripts">Bundled Scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#more-nifty-pause-and-resume">More nifty pause and resume</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="action_commands.html">Action Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="atcommands.html">&#64; Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="safemode.html">Safe mode</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bundledplugins/index.html">Bundled Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../events/index.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Developing Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">Internal Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jsclientlib/index.html">JavaScript Client Library</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OctoPrint</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">



  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Features</a> &raquo;</li>
        
      <li>GCODE Scripts</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/features/gcode_scripts.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gcode-scripts">
<span id="sec-features-gcode-scripts"></span><h1><a class="toc-backref" href="#id6" role="doc-backlink">GCODE Scripts</a><a class="headerlink" href="#gcode-scripts" title="Link to this heading"></a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#gcode-scripts" id="id6">GCODE Scripts</a></p>
<ul>
<li><p><a class="reference internal" href="#predefined-scripts" id="id7">Predefined Scripts</a></p></li>
<li><p><a class="reference internal" href="#events" id="id8">Events</a></p></li>
<li><p><a class="reference internal" href="#snippets" id="id9">Snippets</a></p></li>
<li><p><a class="reference internal" href="#context" id="id10">Context</a></p></li>
<li><p><a class="reference internal" href="#bundled-scripts" id="id11">Bundled Scripts</a></p></li>
<li><p><a class="reference internal" href="#examples" id="id12">Examples</a></p>
<ul>
<li><p><a class="reference internal" href="#more-nifty-pause-and-resume" id="id13">More nifty pause and resume</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<p>OctoPrint allows you to define custom GCODE scripts to be executed on specified occasions, e.g. when a print
starts, when OctoPrint connects to a printer, or when a <a class="reference internal" href="custom_controls.html#sec-features-custom-controls"><span class="std std-ref">button defined as a custom control</span></a>
is clicked.</p>
<p>Unless <a class="reference internal" href="../configuration/config_yaml.html#sec-configuration-config-yaml-folder"><span class="std std-ref">configured otherwise</span></a>, OctoPrint expects scripts to be located in
the <code class="docutils literal notranslate"><span class="pre">scripts/gcode</span></code> folder in OctoPrint configuration directory (per default <code class="docutils literal notranslate"><span class="pre">~/.octoprint</span></code> on Linux, <code class="docutils literal notranslate"><span class="pre">%APPDATA%\OctoPrint</span></code>
on Windows and <code class="docutils literal notranslate"><span class="pre">~/Library/Application</span> <span class="pre">Support/OctoPrint</span></code> on macOS).</p>
<p>These GCODE scripts are backed by the templating engine Jinja2, allowing more than just
simple “send-as-is” scripts but making use of a full blown templating language in order to create your scripts. To
this end, OctoPrint injects some variables into the <a class="reference internal" href="#sec-features-gcode-scripts-context"><span class="std std-ref">template rendering context</span></a>
as described below.</p>
<p>You can find the docs on the Jinja templating engine as used in OctoPrint <a class="reference external" href="https://jinja.palletsprojects.com/en/2.11.x/templates/">here</a>.</p>
<section id="predefined-scripts">
<span id="sec-features-gcode-scripts-predefined"></span><h2><a class="toc-backref" href="#id7" role="doc-backlink">Predefined Scripts</a><a class="headerlink" href="#predefined-scripts" title="Link to this heading"></a></h2>
<p>The following GCODE scripts are sent by OctoPrint automatically:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">afterPrinterConnected</span></code>: Sent after OctoPrint successfully connected to a printer. Defaults to an empty script.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">beforePrinterDisconnected</span></code>: Sent just before OctoPrint (actively) closes the connection to the printer. Defaults
to an empty script. Note that this will <em>not</em> be sent for unexpected connection cut offs, e.g. in case of errors
on the serial line, only when the user clicks the “Disconnect” button or the printer requests a disconnect via an
<a class="reference internal" href="action_commands.html#sec-features-action-commands"><span class="std std-ref">action command</span></a> .</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">beforePrintStarted</span></code>: Sent just before a print job is started. Defaults to an empty script.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">afterPrintCancelled</span></code>: Sent just after a print job was cancelled. Defaults to the
<a class="reference internal" href="#sec-features-gcode-scripts-bundled"><span class="std std-ref">bundled script listed below</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">afterPrintDone</span></code>: Sent just after a print job finished. Defaults to an empty script.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">afterPrintPaused</span></code>: Sent just after a print job was paused. Defaults to an empty script.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">beforePrintResumed</span></code>: Sent just before a print job is resumed. Defaults to an empty script.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">beforeToolChange</span></code>: Sent just before a tool change command (<code class="docutils literal notranslate"><span class="pre">Tn</span></code>) is issued.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">afterToolChange</span></code>: Sent just after a tool change command (<code class="docutils literal notranslate"><span class="pre">Tn</span></code>) is issued</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Plugins may extend these scripts through <a class="reference internal" href="../plugins/hooks.html#sec-plugins-hook-comm-protocol-scripts"><span class="std std-ref">a hook</span></a>.</p>
</div>
</section>
<section id="events">
<span id="sec-features-gcode-scripts-events"></span><h2><a class="toc-backref" href="#id8" role="doc-backlink">Events</a><a class="headerlink" href="#events" title="Link to this heading"></a></h2>
<p>Every GCODE script that is executed will emit two events. The event name will start with ‘GcodeScript’ followed by the capitalized name
of the script. When <code class="docutils literal notranslate"><span class="pre">afterPrintDone</span></code> has started the event will be <code class="docutils literal notranslate"><span class="pre">GcodeScriptAfterPrintDoneRunning</span></code> and once it has completed the last event
will be <code class="docutils literal notranslate"><span class="pre">GcodeScriptAfterPrintDoneFinished</span></code>. You can find more details in the <a class="reference internal" href="../events/index.html#sec-events-available-events-printing"><span class="std std-ref">Events</span></a> documentation.</p>
</section>
<section id="snippets">
<span id="sec-features-gcode-scripts-snippets"></span><h2><a class="toc-backref" href="#id9" role="doc-backlink">Snippets</a><a class="headerlink" href="#snippets" title="Link to this heading"></a></h2>
<p>For making small GCODE snippets reusable in a template (e.g. for <a class="reference internal" href="#sec-features-gcode-scripts-bundled"><span class="std std-ref">disabling all hotends</span></a>)
there’s an additional Jinja template command <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">snippet</span> <span class="pre">'&lt;snippet</span> <span class="pre">name&gt;'</span> <span class="pre">%}</span></code> available which allows including
snippets stored under <code class="docutils literal notranslate"><span class="pre">scripts/gcode/snippets</span></code> in OctoPrint’s configuration directory. They fully support
the whole spectrum of the Jinja2 templating language (that includes including other snippets).</p>
</section>
<section id="context">
<span id="sec-features-gcode-scripts-context"></span><h2><a class="toc-backref" href="#id10" role="doc-backlink">Context</a><a class="headerlink" href="#context" title="Link to this heading"></a></h2>
<p>All GCODE scripts have access to the following template variables through the template context:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">printer_profile</span></code>: The currently selected <a class="reference internal" href="../modules/printer.html#sec-modules-printer-profile"><span class="std std-ref">Printer Profile</span></a>, including
information such as the extruder count, the build volume size, the filament diameter etc. The individual properties
follow the common data model for <a class="reference internal" href="../api/printerprofiles.html#sec-api-printerprofiles-datamodel-profile"><span class="std std-ref">printer profiles</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last_position</span></code>: Last position reported by the printer via <cite>M114</cite> (might be unset if no <cite>M114</cite> was sent so far!).
Consists of <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code> and <code class="docutils literal notranslate"><span class="pre">e</span></code> coordinates as received by the printer and tracked values for <code class="docutils literal notranslate"><span class="pre">f</span></code> and
current tool <code class="docutils literal notranslate"><span class="pre">t</span></code> taken from commands sent through OctoPrint. All of these coordinates might be <code class="docutils literal notranslate"><span class="pre">None</span></code> if no
position could be retrieved from the printer or the values could not be tracked (in case of <code class="docutils literal notranslate"><span class="pre">f</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>)!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last_temperature</span></code>: Last actual and target temperature reported for all available tools and if available the
heated bed. This is a dictionary of key-value pairs. The keys are the indices of the available tools (<code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>,
…) and <code class="docutils literal notranslate"><span class="pre">b</span></code> for the heated bed. The values are a dictionary consisting of <code class="docutils literal notranslate"><span class="pre">actual</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code> keys mapped
to the corresponding temperature in degrees Celsius. Note that not all tools your printer has must necessarily be
present here, neither must the heated bed - it depends on whether OctoPrint has values for a tool or the bed. Also
note that <code class="docutils literal notranslate"><span class="pre">actual</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code> might be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last_fanspeed</span></code>: Last fan speed set. It contains the value taken from command (M106 and M107) sent through OctoPrint.
The value might be <code class="docutils literal notranslate"><span class="pre">None</span></code> if no fan speed has been set.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">script</span></code>: An object wrapping the script’s type (<code class="docutils literal notranslate"><span class="pre">gcode</span></code>) and name (e.g. <code class="docutils literal notranslate"><span class="pre">afterPrintCancelled</span></code>) as <code class="docutils literal notranslate"><span class="pre">script.type</span></code>
and <code class="docutils literal notranslate"><span class="pre">script.name</span></code> respectively.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plugins</span></code>: An object containing variables provided by plugins (e.g <code class="docutils literal notranslate"><span class="pre">plugins.myplugin.myvariable</span></code>)</p></li>
</ul>
</div></blockquote>
<p>There are a few additional template variables available for the following specific scripts:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">afterPrintPaused</span></code> and <code class="docutils literal notranslate"><span class="pre">beforePrintResumed</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">pause_position</span></code>: Position reported by the printer via <code class="docutils literal notranslate"><span class="pre">M114</span></code> immediately before the print was paused. See
<code class="docutils literal notranslate"><span class="pre">last_position</span></code> above for the structure to expect here.</p>
<p><strong>Please note:</strong> This will not be available if you disable
“Log position on pause” under Settings &gt; Serial &gt; Advanced options!</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pause_temperature</span></code>: Last known temperature values when the print was paused. See <code class="docutils literal notranslate"><span class="pre">last_temperature</span></code> above
for the structure to expect here.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pause_fanspeed</span></code>: Last known fan speed value when the print was paused. See <code class="docutils literal notranslate"><span class="pre">last_fanspeed</span></code> above for the structure to expect here.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">afterPrintCancelled</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">cancel_position</span></code>: Position reported by the printer via <code class="docutils literal notranslate"><span class="pre">M114</span></code> immediately before the print was cancelled.
See <code class="docutils literal notranslate"><span class="pre">last_position</span></code> above for the structure to expect here.</p>
<p><strong>Please note:</strong> This will not be available if you disable
“Log position on cancel” under Settings &gt; Serial &gt; Advanced options!</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">cancel_temperature</span></code>: Last known temperature values when the print was cancelled. See <code class="docutils literal notranslate"><span class="pre">last_temperature</span></code> above
for the structure to expect here.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cancel_fanspeed</span></code>: Last known fan speed value when the print was cancelled. See <code class="docutils literal notranslate"><span class="pre">last_fanspeed</span></code> above for the structure to expect here.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">beforeToolChange</span></code> and <code class="docutils literal notranslate"><span class="pre">afterToolChange</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tool.old</span></code>: The number of the previous tool</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tool.new</span></code>: The number of the new tool</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that current firmware implementations only report back one <code class="docutils literal notranslate"><span class="pre">E</span></code> value, the current extrusion value for the current
extruder. Retrieving all <code class="docutils literal notranslate"><span class="pre">E</span></code> values by cycling through all extruders on pause and cancel is something OctoPrint
currently does NOT do since it would simply take too long. That means that if you want to write a <code class="docutils literal notranslate"><span class="pre">beforePrintResumed</span></code>
script that basically resets everything back to the point when the printer was paused <em>and</em> you are running with
multiple extruders, you’ll have to find some other way to have your <code class="docutils literal notranslate"><span class="pre">E</span></code> values set correctly for all your available
extruders - the data available in <code class="docutils literal notranslate"><span class="pre">pause_position</span></code> will <em>not</em> suffice. Additionally, most firmwares don’t report
the currently selected tool in the <code class="docutils literal notranslate"><span class="pre">M114</span></code> response, meaning that the only way OctoPrint can keep track of that is
by tracking it itself. Same goes for the current feed rate <code class="docutils literal notranslate"><span class="pre">F</span></code>. So if you are printing from SD, this data will be
<em>wrong</em>. This is also the reason why OctoPrint currently doesn’t bundle a more sophisticated pause and resume script
that would actually move the print head out of the way and pause and back to the original position on resume - it
might cause issues for the multitude of users out there with multi-extruder setups or for people printing from the
printer’s SD, thanks to the lack of information the firmware provides.</p>
</div>
<p>The <a class="reference internal" href="#sec-features-gcode-scripts-predefined"><span class="std std-ref">predefined GCODE scripts</span></a> are also called with the following additional
template variables:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">event</span></code>: The payload of the <code class="docutils literal notranslate"><span class="pre">Connected</span></code>, <code class="docutils literal notranslate"><span class="pre">PrintStarted</span></code>, <code class="docutils literal notranslate"><span class="pre">PrintCancelled</span></code>, <code class="docutils literal notranslate"><span class="pre">PrintDone</span></code>, <code class="docutils literal notranslate"><span class="pre">PrintPaused</span></code> or
<code class="docutils literal notranslate"><span class="pre">PrintResumed</span></code> event. See <a class="reference internal" href="../events/index.html#sec-events-available-events"><span class="std std-ref">the documentation of events</span></a> for the contained values.</p></li>
</ul>
</div></blockquote>
<p>GCODE scripts attached to <a class="reference internal" href="custom_controls.html#sec-features-custom-controls"><span class="std std-ref">custom controls</span></a> are called with the following
additional template variables:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parameters</span></code>: The parameters as defined for the custom control, if it has any inputs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">context</span></code>: Additional <code class="docutils literal notranslate"><span class="pre">context</span></code> included in the definition of the custom control.</p></li>
</ul>
</div></blockquote>
</section>
<section id="bundled-scripts">
<span id="sec-features-gcode-scripts-bundled"></span><h2><a class="toc-backref" href="#id11" role="doc-backlink">Bundled Scripts</a><a class="headerlink" href="#bundled-scripts" title="Link to this heading"></a></h2>
<p>Out of the box, OctoPrint defaults to the following script setup for <code class="docutils literal notranslate"><span class="pre">afterPrintCancelled</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-number">Listing 3 </span><span class="caption-text">Default <code class="docutils literal notranslate"><span class="pre">afterPrintCancelled</span></code> script</span><a class="headerlink" href="#id1" title="Link to this code"></a></div>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">; disable motors</span>
<span class="x">M84</span>

<span class="x">;disable all heaters</span>
<span class="cp">{%</span> <span class="k">snippet</span> <span class="s1">&#39;disable_hotends&#39;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">snippet</span> <span class="s1">&#39;disable_bed&#39;</span> <span class="cp">%}</span>

<span class="x">;disable fan</span>
<span class="x">M106 S0</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">disable_hotends</span></code> snippet is defined as follows:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-number">Listing 4 </span><span class="caption-text">Default <code class="docutils literal notranslate"><span class="pre">disable_hotends</span></code> snippet</span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">printer_profile.extruder.sharedNozzle</span> <span class="cp">%}</span>
<span class="x">M104 T0 S0</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">tool</span> <span class="k">in</span> <span class="nv">range</span><span class="o">(</span><span class="nv">printer_profile.extruder.count</span><span class="o">)</span> <span class="cp">%}</span>
<span class="x">M104 T</span><span class="cp">{{</span> <span class="nv">tool</span> <span class="cp">}}</span><span class="x"> S0</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">disable_bed</span></code> snippet is defined as follows:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-number">Listing 5 </span><span class="caption-text">Default <code class="docutils literal notranslate"><span class="pre">disable_bed</span></code> snippet</span><a class="headerlink" href="#id3" title="Link to this code"></a></div>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">printer_profile.heatedBed</span> <span class="cp">%}</span>
<span class="x">M140 S0</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
<p>As you can see, the <code class="docutils literal notranslate"><span class="pre">disable_hotends</span></code> and <code class="docutils literal notranslate"><span class="pre">disable_bed</span></code> snippets utilize the
<code class="docutils literal notranslate"><span class="pre">printer_profile</span></code> context variable in order to iterate through all available
extruders and set their temperature to 0, and to also set the bed temperature
to 0 if a heated bed is configured.</p>
</section>
<section id="examples">
<span id="sec-features-gcode-scripts-examples"></span><h2><a class="toc-backref" href="#id12" role="doc-backlink">Examples</a><a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<section id="more-nifty-pause-and-resume">
<span id="sec-features-gcode-scripts-examples-more-nifty-pause-and-resume"></span><h3><a class="toc-backref" href="#id13" role="doc-backlink">More nifty pause and resume</a><a class="headerlink" href="#more-nifty-pause-and-resume" title="Link to this heading"></a></h3>
<p>If you do not have a multi-extruder setup, aren’t printing from SD and have “Log position on pause” enabled under
Settings &gt; Serial Connection &gt; Behaviour &gt; Pausing, the following <code class="docutils literal notranslate"><span class="pre">afterPrintPaused</span></code> and
<code class="docutils literal notranslate"><span class="pre">beforePrintResumed</span></code> scripts might be interesting for you. With something like them in place, OctoPrint will move your print head
out of the way to a safe rest position (here <code class="docutils literal notranslate"><span class="pre">G1</span> <span class="pre">X0</span> <span class="pre">Y0</span></code>, you might want to adjust that) on pause and move it back
to the persisted pause position on resume, making sure to also reset the extruder and feedrate.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-number">Listing 6 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">afterPrintPaused</span></code> script</span><a class="headerlink" href="#id4" title="Link to this code"></a></div>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">; (optional) disable stepper inactivity timeout - uncomment if you printer disables steppers during pause and supports this command</span>
<span class="x">;M18 S0</span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">pause_position.x</span> <span class="k">is</span> <span class="k">not</span> <span class="nf">none</span> <span class="cp">%}</span>
<span class="x">; relative XYZE</span>
<span class="x">G91</span>
<span class="x">M83</span>

<span class="x">; retract filament, move Z slightly upwards</span>
<span class="x">G1 Z+5 E-5 F4500</span>

<span class="x">; absolute XYZE</span>
<span class="x">M82</span>
<span class="x">G90</span>

<span class="x">; move to a safe rest position, adjust as necessary</span>
<span class="x">G1 X0 Y0</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-number">Listing 7 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">beforePrintResumed</span></code> script</span><a class="headerlink" href="#id5" title="Link to this code"></a></div>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">pause_position.x</span> <span class="k">is</span> <span class="k">not</span> <span class="nf">none</span> <span class="cp">%}</span>
<span class="x">; relative extruder</span>
<span class="x">M83</span>

<span class="x">; prime nozzle</span>
<span class="x">G1 E-5 F4500</span>
<span class="x">G1 E5 F4500</span>
<span class="x">G1 E5 F4500</span>

<span class="x">; absolute E</span>
<span class="x">M82</span>

<span class="x">; absolute XYZ</span>
<span class="x">G90</span>

<span class="x">; reset E</span>
<span class="x">G92 E</span><span class="cp">{{</span> <span class="nv">pause_position.e</span> <span class="cp">}}</span>

<span class="x">; move back to pause position XYZ</span>
<span class="x">G1 X</span><span class="cp">{{</span> <span class="nv">pause_position.x</span> <span class="cp">}}</span><span class="x"> Y</span><span class="cp">{{</span> <span class="nv">pause_position.y</span> <span class="cp">}}</span><span class="x"> Z</span><span class="cp">{{</span> <span class="nv">pause_position.z</span> <span class="cp">}}</span><span class="x"> F4500</span>

<span class="x">; reset to feed rate before pause if available</span>
<span class="cp">{%</span> <span class="k">if</span> <span class="nv">pause_position.f</span> <span class="k">is</span> <span class="k">not</span> <span class="nf">none</span> <span class="cp">%}</span><span class="x">G1 F</span><span class="cp">{{</span> <span class="nv">pause_position.f</span> <span class="cp">}}{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As mentioned in the warning above and the description of the example itself, this will <em>only</em> work if you are
not printing from SD and not using multiple extruders since OctoPrint will only then be able to track the
necessary position data and print parameters due to firmware limitations.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://jinja.palletsprojects.com/en/2.11.x/templates/">Jinja Template Designer Documentation</a></dt><dd><p>Jinja’s Template Designer Documentation describes the syntax and semantics of the template language used
also by OctoPrint’s GCODE scripts.</p>
</dd>
</dl>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="custom_controls.html" class="btn btn-neutral float-left" title="Custom Controls" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="action_commands.html" class="btn btn-neutral float-right" title="Action Commands" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2025, Gina Häußge.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: master
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="https://docs.octoprint.org/en/1.11.0rc1/features/gcode_scripts.html">1.11.0rc1</a></dd>
      <dd><a href="https://docs.octoprint.org/en/1.10.3/features/gcode_scripts.html">1.10.3</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="https://docs.octoprint.org/en/master/features/gcode_scripts.html">master</a></dd>
      <dd><a href="https://docs.octoprint.org/en/maintenance/features/gcode_scripts.html">maintenance</a></dd>
      <dd><a href="https://docs.octoprint.org/en/devel/features/gcode_scripts.html">devel</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>